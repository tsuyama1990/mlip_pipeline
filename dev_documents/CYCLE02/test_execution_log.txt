============================= test session starts ==============================
platform linux -- Python 3.12.12, pytest-9.0.2, pluggy-1.6.0
rootdir: /app
configfile: pyproject.toml
testpaths: tests
plugins: mock-3.15.1, anyio-4.12.1
collected 58 items

tests/integration/test_dft_integration.py F                              [  1%]
tests/modules/test_config_generator.py .                                 [  3%]
tests/modules/test_dft.py .....s                                         [ 13%]
tests/modules/test_exploration.py .....ss                                [ 25%]
tests/modules/test_explorer.py .....                                     [ 34%]
tests/modules/test_generator.py ....                                     [ 41%]
tests/modules/test_inference.py ........                                 [ 55%]
tests/modules/test_trainer.py .....                                      [ 63%]
tests/test_app.py .                                                      [ 65%]
tests/test_config_schemas.py ....................                        [100%]

=================================== FAILURES ===================================
_________________________ test_dft_factory_integration _________________________

system_config = SystemConfig(target_system=TargetSystem(elements=['H'], composition={'H': 1.0}), dft=DFTConfig(executable=DFTExecutabl...element_dependent_cutoffs=False)), inference=None, dask=DaskConfig(scheduler_address=None), db_path='mlip_database.db')
h2_atoms = Atoms(symbols='H2', pbc=False)
tmp_path = PosixPath('/tmp/pytest-of-jules/pytest-7/test_dft_factory_integration0')

    def test_dft_factory_integration(
        system_config: SystemConfig, h2_atoms: Atoms, tmp_path: Path
    ) -> None:
        """Test the full DFT calculation pipeline using a mock executable.

        This test verifies that:
        1. A temporary directory is created for the calculation.
        2. The input file is correctly generated and written.
        3. The mock executable is called successfully.
        4. The output file is parsed correctly.
        5. The results (energy, forces, stress) are attached to the Atoms object.
        """
        # Arrange
        # The DFTFactory is instantiated with the configuration pointing to our mock
>       dft_factory = DFTFactory(config=system_config.dft, base_work_dir=tmp_path)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
E       TypeError: DFTFactory.__init__() got an unexpected keyword argument 'config'

tests/integration/test_dft_integration.py:58: TypeError
=============================== warnings summary ===============================
tests/modules/test_dft.py:121
  /app/tests/modules/test_dft.py:121: PytestUnknownMarkWarning: Unknown pytest.mark.integration - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.integration

.venv/lib/python3.12/site-packages/e3nn/o3/_wigner.py:10
  /app/.venv/lib/python3.12/site-packages/e3nn/o3/_wigner.py:10: UserWarning: Environment variable TORCH_FORCE_NO_WEIGHTS_ONLY_LOAD detected, since the`weights_only` argument was not explicitly passed to `torch.load`, forcing weights_only=False.
    _Jd, _W3j_flat, _W3j_indices = torch.load(os.path.join(os.path.dirname(__file__), 'constants.pt'))

tests/modules/test_exploration.py:132
  /app/tests/modules/test_exploration.py:132: PytestUnknownMarkWarning: Unknown pytest.mark.integration - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.integration

tests/modules/test_exploration.py:142
  /app/tests/modules/test_exploration.py:142: PytestUnknownMarkWarning: Unknown pytest.mark.integration - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.integration

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
=========================== short test summary info ============================
FAILED tests/integration/test_dft_integration.py::test_dft_factory_integration
============= 1 failed, 54 passed, 3 skipped, 4 warnings in 9.35s ==============
