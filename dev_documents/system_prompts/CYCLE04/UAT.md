# Cycle 04 User Acceptance Testing (UAT) Plan

## 1. Test Scenarios

### Scenario 4.1: Dataset Creation & Conversion
*   **Goal**: Verify the system can convert ASE structures (generated by Cycle 02/03) into the format required by Pacemaker (`.pckl.gzip` or `.xyz`).
*   **Action**:
    1.  User runs `pyacemaker run-loop` with a few structures.
    2.  User inspects the generated `data/train.pckl.gzip`.
    3.  User tries to load this file with `pandas.read_pickle`.
*   **Success Criteria**:
    *   The file exists.
    *   The loaded DataFrame contains the expected columns (`energy`, `forces`, `ASE_atoms`).
    *   The number of rows matches the number of labeled structures.

### Scenario 4.2: Active Set Selection (D-Optimality)
*   **Goal**: Verify that the Active Set algorithm selects a diverse subset of structures from a larger pool.
*   **Action**:
    1.  User creates a pool of 100 near-identical structures and 10 distinct structures.
    2.  User runs the `ActiveSetSelector` (via CLI or script) asking for `n=20`.
    3.  User inspects the indices of the selected structures.
*   **Success Criteria**:
    *   The distinct structures are all selected.
    *   Only a small number of the identical structures are selected.
    *   The total count is exactly 20.

### Scenario 4.3: Mock Training & Potential Generation
*   **Goal**: Verify that the Trainer can "train" a potential (Mock) and save the result.
*   **Action**:
    1.  User configures `trainer.type: mock`.
    2.  User runs the orchestrator loop.
    3.  User checks `potentials/generation_001.yace`.
*   **Success Criteria**:
    *   The file exists.
    *   The content is a valid dummy string (e.g., "Mock Potential v1").
    *   The logs show "Training completed. RMSE Energy: 0.001 eV/atom".

## 2. Behavior Definitions (Gherkin Style)

### Feature: Dataset Management
**Scenario**: Converting structures to Pacemaker format
  **Given** a list of ASE Atoms with energy/forces
  **When** the DatasetManager processes them
  **Then** a serialized pandas DataFrame should be saved
  **And** it should contain the correct number of entries

### Feature: Active Set Selection
**Scenario**: Selecting diverse structures
  **Given** a pool of candidate structures
  **When** the ActiveSetSelector runs with target size N
  **Then** it should return N indices corresponding to the most distinct structures
  **And** redundant structures should be ignored

### Feature: Potential Training
**Scenario**: Running the training loop
  **Given** a valid training dataset
  **When** the Trainer is invoked
  **Then** it should call the Pacemaker CLI (or mock)
  **And** a `.yace` potential file should be produced
  **And** training metrics (RMSE) should be reported
