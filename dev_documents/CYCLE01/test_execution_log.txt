============================= test session starts ==============================
platform linux -- Python 3.12.12, pytest-9.0.2, pluggy-1.6.0
rootdir: /app
configfile: pyproject.toml
plugins: mock-3.15.1, cov-7.0.0
collected 26 items

tests/test_config.py .....                                               [ 19%]
tests/test_config_factory.py .                                           [ 23%]
tests/test_database.py ..                                                [ 30%]
tests/test_logging.py .                                                  [ 34%]
tests/test_app.py ......                                                 [ 57%]
tests/test_system_config.py .                                            [ 61%]
tests/test_workflow_manager.py .......                                   [ 88%]
tests/uat/cycle_01_uat.py ...                                            [100%]

=============================== warnings summary ===============================
tests/test_workflow_manager.py::test_save_checkpoint
  /app/.venv/lib/python3.12/site-packages/distributed/node.py:188: UserWarning: Port 8787 is already in use.
  Perhaps you already have a cluster running?
  Hosting the HTTP server on port 46743 instead
    warnings.warn(

tests/test_workflow_manager.py::test_load_checkpoint
  /app/.venv/lib/python3.12/site-packages/distributed/node.py:188: UserWarning: Port 8787 is already in use.
  Perhaps you already have a cluster running?
  Hosting the HTTP server on port 36371 instead
    warnings.warn(

tests/test_workflow_manager.py::test_init_does_not_load_state_unnecessarily
  /app/.venv/lib/python3.12/site-packages/distributed/node.py:188: UserWarning: Port 8787 is already in use.
  Perhaps you already have a cluster running?
  Hosting the HTTP server on port 40137 instead
    warnings.warn(

tests/test_workflow_manager.py::test_resubmit_pending_jobs
  /app/.venv/lib/python3.12/site-packages/distributed/node.py:188: UserWarning: Port 8787 is already in use.
  Perhaps you already have a cluster running?
  Hosting the HTTP server on port 42589 instead
    warnings.warn(

tests/test_workflow_manager.py::test_checkpoint_training_history
  /app/.venv/lib/python3.12/site-packages/distributed/node.py:188: UserWarning: Port 8787 is already in use.
  Perhaps you already have a cluster running?
  Hosting the HTTP server on port 34559 instead
    warnings.warn(

tests/test_workflow_manager.py::test_checkpoint_training_history
  /app/.venv/lib/python3.12/site-packages/distributed/node.py:188: UserWarning: Port 8787 is already in use.
  Perhaps you already have a cluster running?
  Hosting the HTTP server on port 33069 instead
    warnings.warn(

tests/test_workflow_manager.py::test_perform_training
  /app/.venv/lib/python3.12/site-packages/distributed/node.py:188: UserWarning: Port 8787 is already in use.
  Perhaps you already have a cluster running?
  Hosting the HTTP server on port 38055 instead
    warnings.warn(

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
================================ tests coverage ================================
_______________ coverage: platform linux, python 3.12.12-final-0 _______________

Name                                                     Stmts   Miss  Cover   Missing
--------------------------------------------------------------------------------------
mlip_autopipec/__init__.py                                   1      0   100%
mlip_autopipec/app.py                                       61      7    89%   65-68, 114-115, 123
mlip_autopipec/config/__init__.py                            0      0   100%
mlip_autopipec/config/factory.py                            37      0   100%
mlip_autopipec/config/loaders/yaml_loader.py                28     19    32%   29-50
mlip_autopipec/config/models.py                              7      0   100%
mlip_autopipec/config/schemas/common.py                     50      0   100%
mlip_autopipec/config/schemas/dft.py                        95     25    74%   26-27, 44-45, 63-64, 66-67, 84-92, 109-112, 117-120
mlip_autopipec/config/schemas/exploration.py                52      5    90%   32-36
mlip_autopipec/config/schemas/inference.py                  71     25    65%   24-25, 39-40, 58-66, 71-82
mlip_autopipec/config/schemas/monitoring.py                 12      0   100%
mlip_autopipec/config/schemas/system.py                     45      0   100%
mlip_autopipec/config/schemas/training.py                   51      2    96%   52-53
mlip_autopipec/core/__init__.py                              3      0   100%
mlip_autopipec/core/database.py                             20      1    95%   20
mlip_autopipec/core/logging.py                               5      0   100%
mlip_autopipec/data/__init__.py                              0      0   100%
mlip_autopipec/data/database.py                             39     39     0%   7-150
mlip_autopipec/exceptions.py                                 8      4    50%   35-37, 41
mlip_autopipec/modules/__init__.py                           0      0   100%
mlip_autopipec/modules/config_generator.py                  15     15     0%   3-74
mlip_autopipec/modules/descriptors.py                       30     30     0%   3-61
mlip_autopipec/modules/dft.py                               84     55    35%   49-52, 64-65, 75-77, 81-86, 90-93, 97-98, 114, 120-121, 144-146, 167-216
mlip_autopipec/modules/dft_handlers/input_generator.py      32     23    28%   32-33, 44-53, 57-65, 71-99
mlip_autopipec/modules/dft_handlers/output_parser.py        18     10    44%   31, 48-62
mlip_autopipec/modules/dft_handlers/process_runner.py       29     19    34%   34, 50-83
mlip_autopipec/modules/dft_handlers/retry.py                22     17    23%   26-47
mlip_autopipec/modules/exploration.py                       51     51     0%   7-130
mlip_autopipec/modules/explorer.py                          46     46     0%   3-96
mlip_autopipec/modules/generator.py                         72     72     0%   3-201
mlip_autopipec/modules/inference.py                        136    136     0%   7-333
mlip_autopipec/modules/screening.py                         41     41     0%   3-68
mlip_autopipec/modules/training.py                          92     74    20%   37, 58-88, 98-134, 146-198
mlip_autopipec/monitoring/__init__.py                        0      0   100%
mlip_autopipec/monitoring/dashboard.py                      65     51    22%   17-43, 54-78, 82-90, 94-105
mlip_autopipec/services/pipeline.py                         24     14    42%   31-56
mlip_autopipec/utils/__init__.py                             0      0   100%
mlip_autopipec/utils/ase_utils.py                           43     32    26%   42-55, 74-88, 103-120
mlip_autopipec/utils/config_utils.py                         7      7     0%   3-38
mlip_autopipec/utils/dask_utils.py                          12      2    83%   33-34
mlip_autopipec/utils/data_loader.py                         15      9    40%   30-38
mlip_autopipec/utils/resilience.py                          35     22    37%   61-100
mlip_autopipec/utils/workflow_utils.py                      32     32     0%   3-53
mlip_autopipec/workflow_manager.py                         106     37    65%   76-79, 89-90, 98, 104-105, 112, 115-116, 121-123, 139-143, 153-189
--------------------------------------------------------------------------------------
TOTAL                                                     1592    922    42%
================== 26 passed, 7 warnings in 86.22s (0:01:26) ===================
[13:02:10] INFO     Retire worker addresses                    scheduler.py:7614
                    (stimulus_id='retire-workers-1768654930.71
                    31438') (0, 1, 2, 3)
           INFO     Closing Nanny at 'tcp://127.0.0.1:43035'.       nanny.py:611
                    Reason: nanny-close
           INFO     Nanny asking worker to close. Reason:           nanny.py:858
                    nanny-close
           INFO     Closing Nanny at 'tcp://127.0.0.1:33131'.       nanny.py:611
                    Reason: nanny-close
           INFO     Nanny asking worker to close. Reason:           nanny.py:858
                    nanny-close
           INFO     Closing Nanny at 'tcp://127.0.0.1:33891'.       nanny.py:611
                    Reason: nanny-close
           INFO     Nanny asking worker to close. Reason:           nanny.py:858
                    nanny-close
           INFO     Closing Nanny at 'tcp://127.0.0.1:45117'.       nanny.py:611
                    Reason: nanny-close
           INFO     Nanny asking worker to close. Reason:           nanny.py:858
                    nanny-close
           INFO     Received 'close-stream' from                     core.py:908
                    tcp://127.0.0.1:50410; closing.
           INFO     Received 'close-stream' from                     core.py:908
                    tcp://127.0.0.1:50424; closing.
           INFO     Received 'close-stream' from                     core.py:908
                    tcp://127.0.0.1:50432; closing.
           INFO     Remove worker addr: tcp://127.0.0.1:37983  scheduler.py:5444
                    name: 0
                    (stimulus_id='handle-worker-cleanup-176865
                    4930.868708')
           INFO     Remove worker addr: tcp://127.0.0.1:40877  scheduler.py:5444
                    name: 1
                    (stimulus_id='handle-worker-cleanup-176865
                    4930.914427')
           INFO     Remove worker addr: tcp://127.0.0.1:46243  scheduler.py:5444
                    name: 2
                    (stimulus_id='handle-worker-cleanup-176865
                    4930.9514813')
           INFO     Received 'close-stream' from                     core.py:908
                    tcp://127.0.0.1:50438; closing.
[13:02:11] INFO     Remove worker addr: tcp://127.0.0.1:37149  scheduler.py:5444
                    name: 3
                    (stimulus_id='handle-worker-cleanup-176865
                    4931.0093553')
           INFO     Lost all workers                           scheduler.py:5582
           INFO     Nanny at 'tcp://127.0.0.1:43035' closed.        nanny.py:626
           INFO     Batched Comm Closed <TCP (closed) Scheduler   batched.py:122
                    connection to worker
                    local=tcp://127.0.0.1:34835
                    remote=tcp://127.0.0.1:50438>
                    ╭──── Traceback (most recent call last) ────╮
                    │ /app/.venv/lib/python3.12/site-packages/d │
                    │ istributed/batched.py:115 in              │
                    │ _background_send                          │
                    │                                           │
                    │   112 │   │   │   │   │   │   payload, se │
                    │   113 │   │   │   │   │   )               │
                    │   114 │   │   │   │   ) as coro:          │
                    │ ❱ 115 │   │   │   │   │   nbytes = yield  │
                    │   116 │   │   │   │   if nbytes < 1e6:    │
                    │   117 │   │   │   │   │   self.recent_mes │
                    │   118 │   │   │   │   else:               │
                    │                                           │
                    │ /app/.venv/lib/python3.12/site-packages/t │
                    │ ornado/gen.py:783 in run                  │
                    │                                           │
                    │   780 │   │   │   │   self.future = None  │
                    │   781 │   │   │   │   try:                │
                    │   782 │   │   │   │   │   try:            │
                    │ ❱ 783 │   │   │   │   │   │   value = fut │
                    │   784 │   │   │   │   │   except Exceptio │
                    │   785 │   │   │   │   │   │   # Save the  │
                    │   786 │   │   │   │   │   │   # gen.throw │
                    │                                           │
                    │ /app/.venv/lib/python3.12/site-packages/d │
                    │ istributed/comm/tcp.py:263 in write       │
                    │                                           │
                    │   260 │   async def write(self, msg, seri │
                    │   261 │   │   stream = self.stream        │
                    │   262 │   │   if stream is None:          │
                    │ ❱ 263 │   │   │   raise CommClosedError() │
                    │   264 │   │                               │
                    │   265 │   │   frames = await to_frames(   │
                    │   266 │   │   │   msg,                    │
                    ╰───────────────────────────────────────────╯
                    CommClosedError
           INFO     Nanny at 'tcp://127.0.0.1:45117' closed.        nanny.py:626
           INFO     Nanny at 'tcp://127.0.0.1:33131' closed.        nanny.py:626
           INFO     Nanny at 'tcp://127.0.0.1:33891' closed.        nanny.py:626
           INFO     Closing scheduler. Reason: unknown         scheduler.py:4343
           INFO     Scheduler closing all comms                scheduler.py:4371
           INFO     Retire worker addresses                    scheduler.py:7614
                    (stimulus_id='retire-workers-1768654931.70
                    11468') (0, 1, 2, 3)
           INFO     Closing Nanny at 'tcp://127.0.0.1:37447'.       nanny.py:611
                    Reason: nanny-close
           INFO     Nanny asking worker to close. Reason:           nanny.py:858
                    nanny-close
           INFO     Closing Nanny at 'tcp://127.0.0.1:35119'.       nanny.py:611
                    Reason: nanny-close
           INFO     Nanny asking worker to close. Reason:           nanny.py:858
                    nanny-close
           INFO     Closing Nanny at 'tcp://127.0.0.1:40253'.       nanny.py:611
                    Reason: nanny-close
           INFO     Nanny asking worker to close. Reason:           nanny.py:858
                    nanny-close
           INFO     Closing Nanny at 'tcp://127.0.0.1:36747'.       nanny.py:611
                    Reason: nanny-close
           INFO     Nanny asking worker to close. Reason:           nanny.py:858
                    nanny-close
           INFO     Received 'close-stream' from                     core.py:908
                    tcp://127.0.0.1:51494; closing.
           INFO     Received 'close-stream' from                     core.py:908
                    tcp://127.0.0.1:51486; closing.
           INFO     Received 'close-stream' from                     core.py:908
                    tcp://127.0.0.1:51500; closing.
           INFO     Remove worker addr: tcp://127.0.0.1:35991  scheduler.py:5444
                    name: 1
                    (stimulus_id='handle-worker-cleanup-176865
                    4931.9149575')
           INFO     Remove worker addr: tcp://127.0.0.1:36143  scheduler.py:5444
                    name: 0
                    (stimulus_id='handle-worker-cleanup-176865
                    4931.9444685')
           INFO     Remove worker addr: tcp://127.0.0.1:44559  scheduler.py:5444
                    name: 2
                    (stimulus_id='handle-worker-cleanup-176865
                    4931.9589515')
           INFO     Received 'close-stream' from                     core.py:908
                    tcp://127.0.0.1:51510; closing.
           INFO     Remove worker addr: tcp://127.0.0.1:43509  scheduler.py:5444
                    name: 3
                    (stimulus_id='handle-worker-cleanup-176865
                    4931.995848')
[13:02:12] INFO     Lost all workers                           scheduler.py:5582
           INFO     Nanny at 'tcp://127.0.0.1:36747' closed.        nanny.py:626
           INFO     Batched Comm Closed <TCP (closed) Scheduler   batched.py:122
                    connection to worker
                    local=tcp://127.0.0.1:35257
                    remote=tcp://127.0.0.1:51510>
                    ╭──── Traceback (most recent call last) ────╮
                    │ /app/.venv/lib/python3.12/site-packages/d │
                    │ istributed/batched.py:115 in              │
                    │ _background_send                          │
                    │                                           │
                    │   112 │   │   │   │   │   │   payload, se │
                    │   113 │   │   │   │   │   )               │
                    │   114 │   │   │   │   ) as coro:          │
                    │ ❱ 115 │   │   │   │   │   nbytes = yield  │
                    │   116 │   │   │   │   if nbytes < 1e6:    │
                    │   117 │   │   │   │   │   self.recent_mes │
                    │   118 │   │   │   │   else:               │
                    │                                           │
                    │ /app/.venv/lib/python3.12/site-packages/t │
                    │ ornado/gen.py:783 in run                  │
                    │                                           │
                    │   780 │   │   │   │   self.future = None  │
                    │   781 │   │   │   │   try:                │
                    │   782 │   │   │   │   │   try:            │
                    │ ❱ 783 │   │   │   │   │   │   value = fut │
                    │   784 │   │   │   │   │   except Exceptio │
                    │   785 │   │   │   │   │   │   # Save the  │
                    │   786 │   │   │   │   │   │   # gen.throw │
                    │                                           │
                    │ /app/.venv/lib/python3.12/site-packages/d │
                    │ istributed/comm/tcp.py:263 in write       │
                    │                                           │
                    │   260 │   async def write(self, msg, seri │
                    │   261 │   │   stream = self.stream        │
                    │   262 │   │   if stream is None:          │
                    │ ❱ 263 │   │   │   raise CommClosedError() │
                    │   264 │   │                               │
                    │   265 │   │   frames = await to_frames(   │
                    │   266 │   │   │   msg,                    │
                    ╰───────────────────────────────────────────╯
                    CommClosedError
           INFO     Nanny at 'tcp://127.0.0.1:35119' closed.        nanny.py:626
           INFO     Nanny at 'tcp://127.0.0.1:40253' closed.        nanny.py:626
           INFO     Nanny at 'tcp://127.0.0.1:37447' closed.        nanny.py:626
           INFO     Closing scheduler. Reason: unknown         scheduler.py:4343
           INFO     Scheduler closing all comms                scheduler.py:4371
           INFO     Retire worker addresses                    scheduler.py:7614
                    (stimulus_id='retire-workers-1768654932.40
                    1182') (0, 1, 2, 3)
           INFO     Closing Nanny at 'tcp://127.0.0.1:42957'.       nanny.py:611
                    Reason: nanny-close
           INFO     Nanny asking worker to close. Reason:           nanny.py:858
                    nanny-close
           INFO     Closing Nanny at 'tcp://127.0.0.1:39327'.       nanny.py:611
                    Reason: nanny-close
           INFO     Nanny asking worker to close. Reason:           nanny.py:858
                    nanny-close
           INFO     Closing Nanny at 'tcp://127.0.0.1:37435'.       nanny.py:611
                    Reason: nanny-close
           INFO     Nanny asking worker to close. Reason:           nanny.py:858
                    nanny-close
           INFO     Closing Nanny at 'tcp://127.0.0.1:41591'.       nanny.py:611
                    Reason: nanny-close
           INFO     Nanny asking worker to close. Reason:           nanny.py:858
                    nanny-close
           INFO     Received 'close-stream' from                     core.py:908
                    tcp://127.0.0.1:51706; closing.
           INFO     Received 'close-stream' from                     core.py:908
                    tcp://127.0.0.1:51694; closing.
           INFO     Remove worker addr: tcp://127.0.0.1:38463  scheduler.py:5444
                    name: 0
                    (stimulus_id='handle-worker-cleanup-176865
                    4932.4658701')
           INFO     Remove worker addr: tcp://127.0.0.1:33169  scheduler.py:5444
                    name: 1
                    (stimulus_id='handle-worker-cleanup-176865
                    4932.4861283')
           INFO     Received 'close-stream' from                     core.py:908
                    tcp://127.0.0.1:51722; closing.
           INFO     Remove worker addr: tcp://127.0.0.1:32993  scheduler.py:5444
                    name: 3
                    (stimulus_id='handle-worker-cleanup-176865
                    4932.5033634')
           INFO     Received 'close-stream' from                     core.py:908
                    tcp://127.0.0.1:51714; closing.
           INFO     Remove worker addr: tcp://127.0.0.1:34815  scheduler.py:5444
                    name: 2
                    (stimulus_id='handle-worker-cleanup-176865
                    4932.5461712')
           INFO     Lost all workers                           scheduler.py:5582
           INFO     Nanny at 'tcp://127.0.0.1:41591' closed.        nanny.py:626
           INFO     Nanny at 'tcp://127.0.0.1:42957' closed.        nanny.py:626
           INFO     Nanny at 'tcp://127.0.0.1:37435' closed.        nanny.py:626
           INFO     Nanny at 'tcp://127.0.0.1:39327' closed.        nanny.py:626
           INFO     Closing scheduler. Reason: unknown         scheduler.py:4343
           INFO     Scheduler closing all comms                scheduler.py:4371
           INFO     Retire worker addresses                    scheduler.py:7614
                    (stimulus_id='retire-workers-1768654932.72
                    53106') (0, 1, 2, 3)
           INFO     Closing Nanny at 'tcp://127.0.0.1:46669'.       nanny.py:611
                    Reason: nanny-close
           INFO     Nanny asking worker to close. Reason:           nanny.py:858
                    nanny-close
           INFO     Closing Nanny at 'tcp://127.0.0.1:42331'.       nanny.py:611
                    Reason: nanny-close
           INFO     Nanny asking worker to close. Reason:           nanny.py:858
                    nanny-close
           INFO     Closing Nanny at 'tcp://127.0.0.1:33553'.       nanny.py:611
                    Reason: nanny-close
           INFO     Nanny asking worker to close. Reason:           nanny.py:858
                    nanny-close
           INFO     Closing Nanny at 'tcp://127.0.0.1:38835'.       nanny.py:611
                    Reason: nanny-close
           INFO     Nanny asking worker to close. Reason:           nanny.py:858
                    nanny-close
           INFO     Received 'close-stream' from                     core.py:908
                    tcp://127.0.0.1:49306; closing.
           INFO     Received 'close-stream' from                     core.py:908
                    tcp://127.0.0.1:49326; closing.
           INFO     Received 'close-stream' from                     core.py:908
                    tcp://127.0.0.1:49322; closing.
           INFO     Remove worker addr: tcp://127.0.0.1:36387  scheduler.py:5444
                    name: 0
                    (stimulus_id='handle-worker-cleanup-176865
                    4932.83387')
           INFO     Remove worker addr: tcp://127.0.0.1:39587  scheduler.py:5444
                    name: 1
                    (stimulus_id='handle-worker-cleanup-176865
                    4932.8521867')
           INFO     Remove worker addr: tcp://127.0.0.1:37289  scheduler.py:5444
                    name: 2
                    (stimulus_id='handle-worker-cleanup-176865
                    4932.8793414')
           INFO     Received 'close-stream' from                     core.py:908
                    tcp://127.0.0.1:49342; closing.
           INFO     Remove worker addr: tcp://127.0.0.1:37291  scheduler.py:5444
                    name: 3
                    (stimulus_id='handle-worker-cleanup-176865
                    4932.9065595')
           INFO     Lost all workers                           scheduler.py:5582
           INFO     Nanny at 'tcp://127.0.0.1:46669' closed.        nanny.py:626
           INFO     Nanny at 'tcp://127.0.0.1:42331' closed.        nanny.py:626
           INFO     Nanny at 'tcp://127.0.0.1:33553' closed.        nanny.py:626
[13:02:13] INFO     Nanny at 'tcp://127.0.0.1:38835' closed.        nanny.py:626
           INFO     Closing scheduler. Reason: unknown         scheduler.py:4343
           INFO     Scheduler closing all comms                scheduler.py:4371
           INFO     Retire worker addresses                    scheduler.py:7614
                    (stimulus_id='retire-workers-1768654933.03
                    59597') (0, 1, 2, 3)
           INFO     Closing Nanny at 'tcp://127.0.0.1:41391'.       nanny.py:611
                    Reason: nanny-close
           INFO     Nanny asking worker to close. Reason:           nanny.py:858
                    nanny-close
           INFO     Closing Nanny at 'tcp://127.0.0.1:46011'.       nanny.py:611
                    Reason: nanny-close
           INFO     Nanny asking worker to close. Reason:           nanny.py:858
                    nanny-close
           INFO     Closing Nanny at 'tcp://127.0.0.1:41523'.       nanny.py:611
                    Reason: nanny-close
           INFO     Nanny asking worker to close. Reason:           nanny.py:858
                    nanny-close
           INFO     Closing Nanny at 'tcp://127.0.0.1:35141'.       nanny.py:611
                    Reason: nanny-close
           INFO     Nanny asking worker to close. Reason:           nanny.py:858
                    nanny-close
           INFO     Received 'close-stream' from                     core.py:908
                    tcp://127.0.0.1:53916; closing.
           INFO     Received 'close-stream' from                     core.py:908
                    tcp://127.0.0.1:53904; closing.
           INFO     Received 'close-stream' from                     core.py:908
                    tcp://127.0.0.1:53894; closing.
           INFO     Remove worker addr: tcp://127.0.0.1:32941  scheduler.py:5444
                    name: 0
                    (stimulus_id='handle-worker-cleanup-176865
                    4933.10167')
           INFO     Remove worker addr: tcp://127.0.0.1:38423  scheduler.py:5444
                    name: 1
                    (stimulus_id='handle-worker-cleanup-176865
                    4933.1149814')
           INFO     Remove worker addr: tcp://127.0.0.1:38771  scheduler.py:5444
                    name: 2
                    (stimulus_id='handle-worker-cleanup-176865
                    4933.1185894')
           INFO     Received 'close-stream' from                     core.py:908
                    tcp://127.0.0.1:53920; closing.
           INFO     Remove worker addr: tcp://127.0.0.1:34839  scheduler.py:5444
                    name: 3
                    (stimulus_id='handle-worker-cleanup-176865
                    4933.1468792')
           INFO     Lost all workers                           scheduler.py:5582
           INFO     Nanny at 'tcp://127.0.0.1:41391' closed.        nanny.py:626
           INFO     Nanny at 'tcp://127.0.0.1:35141' closed.        nanny.py:626
           INFO     Nanny at 'tcp://127.0.0.1:46011' closed.        nanny.py:626
           INFO     Nanny at 'tcp://127.0.0.1:41523' closed.        nanny.py:626
           INFO     Closing scheduler. Reason: unknown         scheduler.py:4343
           INFO     Scheduler closing all comms                scheduler.py:4371
           INFO     Retire worker addresses                    scheduler.py:7614
                    (stimulus_id='retire-workers-1768654933.29
                    4076') (0, 1, 2, 3)
           INFO     Closing Nanny at 'tcp://127.0.0.1:45297'.       nanny.py:611
                    Reason: nanny-close
           INFO     Nanny asking worker to close. Reason:           nanny.py:858
                    nanny-close
           INFO     Closing Nanny at 'tcp://127.0.0.1:33249'.       nanny.py:611
                    Reason: nanny-close
           INFO     Nanny asking worker to close. Reason:           nanny.py:858
                    nanny-close
           INFO     Closing Nanny at 'tcp://127.0.0.1:46307'.       nanny.py:611
                    Reason: nanny-close
           INFO     Nanny asking worker to close. Reason:           nanny.py:858
                    nanny-close
           INFO     Closing Nanny at 'tcp://127.0.0.1:35145'.       nanny.py:611
                    Reason: nanny-close
           INFO     Nanny asking worker to close. Reason:           nanny.py:858
                    nanny-close
           INFO     Received 'close-stream' from                     core.py:908
                    tcp://127.0.0.1:55368; closing.
           INFO     Received 'close-stream' from                     core.py:908
                    tcp://127.0.0.1:55374; closing.
           INFO     Received 'close-stream' from                     core.py:908
                    tcp://127.0.0.1:55380; closing.
           INFO     Remove worker addr: tcp://127.0.0.1:44565  scheduler.py:5444
                    name: 0
                    (stimulus_id='handle-worker-cleanup-176865
                    4933.3615737')
           INFO     Remove worker addr: tcp://127.0.0.1:45853  scheduler.py:5444
                    name: 1
                    (stimulus_id='handle-worker-cleanup-176865
                    4933.3713536')
           INFO     Remove worker addr: tcp://127.0.0.1:42939  scheduler.py:5444
                    name: 2
                    (stimulus_id='handle-worker-cleanup-176865
                    4933.386909')
           INFO     Received 'close-stream' from                     core.py:908
                    tcp://127.0.0.1:55382; closing.
           INFO     Remove worker addr: tcp://127.0.0.1:37825  scheduler.py:5444
                    name: 3
                    (stimulus_id='handle-worker-cleanup-176865
                    4933.4166567')
           INFO     Lost all workers                           scheduler.py:5582
           INFO     Nanny at 'tcp://127.0.0.1:45297' closed.        nanny.py:626
           INFO     Nanny at 'tcp://127.0.0.1:33249' closed.        nanny.py:626
           INFO     Nanny at 'tcp://127.0.0.1:35145' closed.        nanny.py:626
           INFO     Nanny at 'tcp://127.0.0.1:46307' closed.        nanny.py:626
           INFO     Closing scheduler. Reason: unknown         scheduler.py:4343
           INFO     Scheduler closing all comms                scheduler.py:4371
           INFO     Retire worker addresses                    scheduler.py:7614
                    (stimulus_id='retire-workers-1768654933.56
                    96404') (0, 1, 2, 3)
           INFO     Closing Nanny at 'tcp://127.0.0.1:43719'.       nanny.py:611
                    Reason: nanny-close
           INFO     Nanny asking worker to close. Reason:           nanny.py:858
                    nanny-close
           INFO     Closing Nanny at 'tcp://127.0.0.1:39741'.       nanny.py:611
                    Reason: nanny-close
           INFO     Nanny asking worker to close. Reason:           nanny.py:858
                    nanny-close
           INFO     Closing Nanny at 'tcp://127.0.0.1:41521'.       nanny.py:611
                    Reason: nanny-close
           INFO     Nanny asking worker to close. Reason:           nanny.py:858
                    nanny-close
           INFO     Closing Nanny at 'tcp://127.0.0.1:46405'.       nanny.py:611
                    Reason: nanny-close
           INFO     Nanny asking worker to close. Reason:           nanny.py:858
                    nanny-close
           INFO     Received 'close-stream' from                     core.py:908
                    tcp://127.0.0.1:35792; closing.
           INFO     Received 'close-stream' from                     core.py:908
                    tcp://127.0.0.1:35780; closing.
           INFO     Remove worker addr: tcp://127.0.0.1:33191  scheduler.py:5444
                    name: 0
                    (stimulus_id='handle-worker-cleanup-176865
                    4933.6161969')
           INFO     Remove worker addr: tcp://127.0.0.1:45343  scheduler.py:5444
                    name: 1
                    (stimulus_id='handle-worker-cleanup-176865
                    4933.6246178')
           INFO     Received 'close-stream' from                     core.py:908
                    tcp://127.0.0.1:35798; closing.
           INFO     Remove worker addr: tcp://127.0.0.1:46615  scheduler.py:5444
                    name: 2
                    (stimulus_id='handle-worker-cleanup-176865
                    4933.644028')
           INFO     Received 'close-stream' from                     core.py:908
                    tcp://127.0.0.1:35806; closing.
           INFO     Batched Comm Closed <TCP (closed) Scheduler   batched.py:122
                    connection to worker
                    local=tcp://127.0.0.1:38589
                    remote=tcp://127.0.0.1:35798>
                    ╭──── Traceback (most recent call last) ────╮
                    │ /app/.venv/lib/python3.12/site-packages/d │
                    │ istributed/batched.py:115 in              │
                    │ _background_send                          │
                    │                                           │
                    │   112 │   │   │   │   │   │   payload, se │
                    │   113 │   │   │   │   │   )               │
                    │   114 │   │   │   │   ) as coro:          │
                    │ ❱ 115 │   │   │   │   │   nbytes = yield  │
                    │   116 │   │   │   │   if nbytes < 1e6:    │
                    │   117 │   │   │   │   │   self.recent_mes │
                    │   118 │   │   │   │   else:               │
                    │                                           │
                    │ /app/.venv/lib/python3.12/site-packages/t │
                    │ ornado/gen.py:783 in run                  │
                    │                                           │
                    │   780 │   │   │   │   self.future = None  │
                    │   781 │   │   │   │   try:                │
                    │   782 │   │   │   │   │   try:            │
                    │ ❱ 783 │   │   │   │   │   │   value = fut │
                    │   784 │   │   │   │   │   except Exceptio │
                    │   785 │   │   │   │   │   │   # Save the  │
                    │   786 │   │   │   │   │   │   # gen.throw │
                    │                                           │
                    │ /app/.venv/lib/python3.12/site-packages/d │
                    │ istributed/comm/tcp.py:263 in write       │
                    │                                           │
                    │   260 │   async def write(self, msg, seri │
                    │   261 │   │   stream = self.stream        │
                    │   262 │   │   if stream is None:          │
                    │ ❱ 263 │   │   │   raise CommClosedError() │
                    │   264 │   │                               │
                    │   265 │   │   frames = await to_frames(   │
                    │   266 │   │   │   msg,                    │
                    ╰───────────────────────────────────────────╯
                    CommClosedError
           INFO     Remove worker addr: tcp://127.0.0.1:40797  scheduler.py:5444
                    name: 3
                    (stimulus_id='handle-worker-cleanup-176865
                    4933.869898')
           INFO     Lost all workers                           scheduler.py:5582
           INFO     Nanny at 'tcp://127.0.0.1:43719' closed.        nanny.py:626
           INFO     Nanny at 'tcp://127.0.0.1:41521' closed.        nanny.py:626
           INFO     Nanny at 'tcp://127.0.0.1:39741' closed.        nanny.py:626
           INFO     Nanny at 'tcp://127.0.0.1:46405' closed.        nanny.py:626
           INFO     Closing scheduler. Reason: unknown         scheduler.py:4343
           INFO     Scheduler closing all comms                scheduler.py:4371
           INFO     Retire worker addresses                    scheduler.py:7614
                    (stimulus_id='retire-workers-1768654933.91
                    57312') (0, 1, 2, 3)
           INFO     Closing Nanny at 'tcp://127.0.0.1:33765'.       nanny.py:611
                    Reason: nanny-close
           INFO     Nanny asking worker to close. Reason:           nanny.py:858
                    nanny-close
           INFO     Closing Nanny at 'tcp://127.0.0.1:39273'.       nanny.py:611
                    Reason: nanny-close
           INFO     Nanny asking worker to close. Reason:           nanny.py:858
                    nanny-close
           INFO     Closing Nanny at 'tcp://127.0.0.1:37779'.       nanny.py:611
                    Reason: nanny-close
           INFO     Nanny asking worker to close. Reason:           nanny.py:858
                    nanny-close
           INFO     Closing Nanny at 'tcp://127.0.0.1:38513'.       nanny.py:611
                    Reason: nanny-close
           INFO     Nanny asking worker to close. Reason:           nanny.py:858
                    nanny-close
           INFO     Received 'close-stream' from                     core.py:908
                    tcp://127.0.0.1:49450; closing.
           INFO     Received 'close-stream' from                     core.py:908
                    tcp://127.0.0.1:49454; closing.
           INFO     Remove worker addr: tcp://127.0.0.1:38663  scheduler.py:5444
                    name: 0
                    (stimulus_id='handle-worker-cleanup-176865
                    4933.949187')
           INFO     Remove worker addr: tcp://127.0.0.1:41875  scheduler.py:5444
                    name: 1
                    (stimulus_id='handle-worker-cleanup-176865
                    4933.9526765')
           INFO     Received 'close-stream' from                     core.py:908
                    tcp://127.0.0.1:49458; closing.
           INFO     Remove worker addr: tcp://127.0.0.1:45515  scheduler.py:5444
                    name: 2
                    (stimulus_id='handle-worker-cleanup-176865
                    4933.9607265')
           INFO     Received 'close-stream' from                     core.py:908
                    tcp://127.0.0.1:49464; closing.
           INFO     Remove worker addr: tcp://127.0.0.1:43565  scheduler.py:5444
                    name: 3
                    (stimulus_id='handle-worker-cleanup-176865
                    4933.9676647')
           INFO     Lost all workers                           scheduler.py:5582
[13:02:14] INFO     Nanny at 'tcp://127.0.0.1:33765' closed.        nanny.py:626
           INFO     Nanny at 'tcp://127.0.0.1:39273' closed.        nanny.py:626
           INFO     Nanny at 'tcp://127.0.0.1:38513' closed.        nanny.py:626
           INFO     Nanny at 'tcp://127.0.0.1:37779' closed.        nanny.py:626
           INFO     Closing scheduler. Reason: unknown         scheduler.py:4343
           INFO     Scheduler closing all comms                scheduler.py:4371
