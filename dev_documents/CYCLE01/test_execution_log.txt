============================= test session starts ==============================
platform linux -- Python 3.12.12, pytest-9.0.2, pluggy-1.6.0
rootdir: /app
configfile: pyproject.toml
testpaths: tests
plugins: mock-3.15.1, cov-7.0.0
collected 72 items

tests/integration/test_dft_integration.py ....                           [  5%]
tests/integration/test_monitoring_integration.py ...                     [  9%]
tests/modules/test_config_generator.py .                                 [ 11%]
tests/modules/test_dft.py ...F..                                         [ 19%]
tests/modules/test_dft_heuristics.py .......                             [ 29%]
tests/modules/test_exploration.py .....ss                                [ 38%]
tests/modules/test_explorer.py ....                                      [ 44%]
tests/modules/test_generator.py ....                                     [ 50%]
tests/modules/test_inference.py ...                                      [ 54%]
tests/modules/test_training.py ....                                      [ 59%]
tests/test_app.py ...                                                    [ 63%]
tests/test_config.py .....                                               [ 70%]
tests/test_config_factory.py .                                           [ 72%]
tests/test_database.py ...                                               [ 76%]
tests/test_logging.py .                                                  [ 77%]
tests/test_monitoring.py ...                                             [ 81%]
tests/test_workflow_manager.py .......                                   [ 91%]
tests/utils/test_resilience.py ......
WARNING: Failed to generate report: No data to report.

                                                                         [100%]

=================================== FAILURES ===================================
______________________ test_process_runner_logs_on_error _______________________

caplog = <_pytest.logging.LogCaptureFixture object at 0x7f37759abf20>
tmp_path = PosixPath('/tmp/pytest-of-jules/pytest-24/test_process_runner_logs_on_er0')

    def test_process_runner_logs_on_error(caplog, tmp_path):
        """Verify that the QEProcessRunner logs stdout/stderr on failure."""
        mock_profile = MagicMock(spec=EspressoProfile)
        mock_profile.get_command.return_value = ["non_existent_command"]
        runner = QEProcessRunner(profile=mock_profile)

        input_file = tmp_path / "test.in"
        output_file = tmp_path / "test.out"
        input_file.touch()

        with pytest.raises(FileNotFoundError):
            runner.execute(input_file, output_file)
>       assert "QE executable not found" in caplog.text
E       AssertionError: assert 'QE executable not found' in ''
E        +  where '' = <_pytest.logging.LogCaptureFixture object at 0x7f37759abf20>.text

tests/modules/test_dft.py:137: AssertionError
=============================== warnings summary ===============================
.venv/lib/python3.12/site-packages/e3nn/o3/_wigner.py:10
  /app/.venv/lib/python3.12/site-packages/e3nn/o3/_wigner.py:10: UserWarning: Environment variable TORCH_FORCE_NO_WEIGHTS_ONLY_LOAD detected, since the`weights_only` argument was not explicitly passed to `torch.load`, forcing weights_only=False.
    _Jd, _W3j_flat, _W3j_indices = torch.load(os.path.join(os.path.dirname(__file__), 'constants.pt'))

tests/modules/test_exploration.py:128
  /app/tests/modules/test_exploration.py:128: PytestUnknownMarkWarning: Unknown pytest.mark.integration - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.integration

tests/modules/test_exploration.py:138
  /app/tests/modules/test_exploration.py:138: PytestUnknownMarkWarning: Unknown pytest.mark.integration - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.integration

tests/modules/test_inference.py:70
  /app/tests/modules/test_inference.py:70: PytestUnknownMarkWarning: Unknown pytest.mark.integration - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.integration

tests/test_workflow_manager.py::test_save_checkpoint
  /app/.venv/lib/python3.12/site-packages/distributed/node.py:188: UserWarning:

  Port 8787 is already in use.
  Perhaps you already have a cluster running?
  Hosting the HTTP server on port 42135 instead

tests/test_workflow_manager.py::test_load_checkpoint
  /app/.venv/lib/python3.12/site-packages/distributed/node.py:188: UserWarning:

  Port 8787 is already in use.
  Perhaps you already have a cluster running?
  Hosting the HTTP server on port 41991 instead

tests/test_workflow_manager.py::test_init_does_not_load_state_unnecessarily
  /app/.venv/lib/python3.12/site-packages/distributed/node.py:188: UserWarning:

  Port 8787 is already in use.
  Perhaps you already have a cluster running?
  Hosting the HTTP server on port 42259 instead

tests/test_workflow_manager.py::test_resubmit_pending_jobs
  /app/.venv/lib/python3.12/site-packages/distributed/node.py:188: UserWarning:

  Port 8787 is already in use.
  Perhaps you already have a cluster running?
  Hosting the HTTP server on port 37051 instead

tests/test_workflow_manager.py::test_checkpoint_training_history
  /app/.venv/lib/python3.12/site-packages/distributed/node.py:188: UserWarning:

  Port 8787 is already in use.
  Perhaps you already have a cluster running?
  Hosting the HTTP server on port 41041 instead

tests/test_workflow_manager.py::test_checkpoint_training_history
  /app/.venv/lib/python3.12/site-packages/distributed/node.py:188: UserWarning:

  Port 8787 is already in use.
  Perhaps you already have a cluster running?
  Hosting the HTTP server on port 42017 instead

tests/test_workflow_manager.py::test_perform_training
  /app/.venv/lib/python3.12/site-packages/distributed/node.py:188: UserWarning:

  Port 8787 is already in use.
  Perhaps you already have a cluster running?
  Hosting the HTTP server on port 35277 instead

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
================================ tests coverage ================================
_______________ coverage: platform linux, python 3.12.12-final-0 _______________

=========================== short test summary info ============================
FAILED tests/modules/test_dft.py::test_process_runner_logs_on_error - Asserti...
======= 1 failed, 69 passed, 2 skipped, 11 warnings in 139.70s (0:02:19) =======
[12:17:29] INFO     Retire worker addresses                    scheduler.py:7614
                    (stimulus_id='retire-workers-1768652249.98
                    90199') (0, 1, 2, 3)
[12:17:30] INFO     Closing Nanny at 'tcp://127.0.0.1:34407'.       nanny.py:611
                    Reason: nanny-close
           INFO     Nanny asking worker to close. Reason:           nanny.py:858
                    nanny-close
           INFO     Closing Nanny at 'tcp://127.0.0.1:33449'.       nanny.py:611
                    Reason: nanny-close
           INFO     Nanny asking worker to close. Reason:           nanny.py:858
                    nanny-close
           INFO     Closing Nanny at 'tcp://127.0.0.1:46693'.       nanny.py:611
                    Reason: nanny-close
           INFO     Nanny asking worker to close. Reason:           nanny.py:858
                    nanny-close
           INFO     Closing Nanny at 'tcp://127.0.0.1:35145'.       nanny.py:611
                    Reason: nanny-close
           INFO     Nanny asking worker to close. Reason:           nanny.py:858
                    nanny-close
           INFO     Received 'close-stream' from                     core.py:908
                    tcp://127.0.0.1:41592; closing.
           INFO     Received 'close-stream' from                     core.py:908
                    tcp://127.0.0.1:41608; closing.
           INFO     Received 'close-stream' from                     core.py:908
                    tcp://127.0.0.1:41606; closing.
           INFO     Remove worker addr: tcp://127.0.0.1:33031  scheduler.py:5444
                    name: 0
                    (stimulus_id='handle-worker-cleanup-176865
                    2250.1449633')
           INFO     Remove worker addr: tcp://127.0.0.1:35273  scheduler.py:5444
                    name: 2
                    (stimulus_id='handle-worker-cleanup-176865
                    2250.1577575')
           INFO     Remove worker addr: tcp://127.0.0.1:36693  scheduler.py:5444
                    name: 1
                    (stimulus_id='handle-worker-cleanup-176865
                    2250.1678865')
           INFO     Received 'close-stream' from                     core.py:908
                    tcp://127.0.0.1:41622; closing.
           INFO     Remove worker addr: tcp://127.0.0.1:46555  scheduler.py:5444
                    name: 3
                    (stimulus_id='handle-worker-cleanup-176865
                    2250.218437')
           INFO     Lost all workers                           scheduler.py:5582
           INFO     Batched Comm Closed <TCP (closed) Scheduler   batched.py:122
                    connection to worker
                    local=tcp://127.0.0.1:43717
                    remote=tcp://127.0.0.1:41622>
                    ╭──── Traceback (most recent call last) ────╮
                    │ /app/.venv/lib/python3.12/site-packages/d │
                    │ istributed/batched.py:115 in              │
                    │ _background_send                          │
                    │                                           │
                    │   112 │   │   │   │   │   │   payload, se │
                    │   113 │   │   │   │   │   )               │
                    │   114 │   │   │   │   ) as coro:          │
                    │ ❱ 115 │   │   │   │   │   nbytes = yield  │
                    │   116 │   │   │   │   if nbytes < 1e6:    │
                    │   117 │   │   │   │   │   self.recent_mes │
                    │   118 │   │   │   │   else:               │
                    │                                           │
                    │ /app/.venv/lib/python3.12/site-packages/t │
                    │ ornado/gen.py:783 in run                  │
                    │                                           │
                    │   780 │   │   │   │   self.future = None  │
                    │   781 │   │   │   │   try:                │
                    │   782 │   │   │   │   │   try:            │
                    │ ❱ 783 │   │   │   │   │   │   value = fut │
                    │   784 │   │   │   │   │   except Exceptio │
                    │   785 │   │   │   │   │   │   # Save the  │
                    │   786 │   │   │   │   │   │   # gen.throw │
                    │                                           │
                    │ /app/.venv/lib/python3.12/site-packages/d │
                    │ istributed/comm/tcp.py:263 in write       │
                    │                                           │
                    │   260 │   async def write(self, msg, seri │
                    │   261 │   │   stream = self.stream        │
                    │   262 │   │   if stream is None:          │
                    │ ❱ 263 │   │   │   raise CommClosedError() │
                    │   264 │   │                               │
                    │   265 │   │   frames = await to_frames(   │
                    │   266 │   │   │   msg,                    │
                    ╰───────────────────────────────────────────╯
                    CommClosedError
           INFO     Nanny at 'tcp://127.0.0.1:33449' closed.        nanny.py:626
           INFO     Nanny at 'tcp://127.0.0.1:35145' closed.        nanny.py:626
           INFO     Nanny at 'tcp://127.0.0.1:46693' closed.        nanny.py:626
           INFO     Nanny at 'tcp://127.0.0.1:34407' closed.        nanny.py:626
           INFO     Closing scheduler. Reason: unknown         scheduler.py:4343
           INFO     Scheduler closing all comms                scheduler.py:4371
           INFO     Retire worker addresses                    scheduler.py:7614
                    (stimulus_id='retire-workers-1768652250.82
                    339') (0, 1, 2, 3)
           INFO     Closing Nanny at 'tcp://127.0.0.1:38879'.       nanny.py:611
                    Reason: nanny-close
           INFO     Nanny asking worker to close. Reason:           nanny.py:858
                    nanny-close
           INFO     Closing Nanny at 'tcp://127.0.0.1:36395'.       nanny.py:611
                    Reason: nanny-close
           INFO     Nanny asking worker to close. Reason:           nanny.py:858
                    nanny-close
           INFO     Closing Nanny at 'tcp://127.0.0.1:34917'.       nanny.py:611
                    Reason: nanny-close
           INFO     Nanny asking worker to close. Reason:           nanny.py:858
                    nanny-close
           INFO     Closing Nanny at 'tcp://127.0.0.1:46329'.       nanny.py:611
                    Reason: nanny-close
           INFO     Nanny asking worker to close. Reason:           nanny.py:858
                    nanny-close
           INFO     Received 'close-stream' from                     core.py:908
                    tcp://127.0.0.1:48400; closing.
           INFO     Received 'close-stream' from                     core.py:908
                    tcp://127.0.0.1:48382; closing.
[12:17:31] INFO     Remove worker addr: tcp://127.0.0.1:34195  scheduler.py:5444
                    name: 0
                    (stimulus_id='handle-worker-cleanup-176865
                    2251.0815237')
           INFO     Remove worker addr: tcp://127.0.0.1:40807  scheduler.py:5444
                    name: 1
                    (stimulus_id='handle-worker-cleanup-176865
                    2251.087588')
           INFO     Received 'close-stream' from                     core.py:908
                    tcp://127.0.0.1:48384; closing.
           INFO     Received 'close-stream' from                     core.py:908
                    tcp://127.0.0.1:48404; closing.
           INFO     Remove worker addr: tcp://127.0.0.1:44161  scheduler.py:5444
                    name: 2
                    (stimulus_id='handle-worker-cleanup-176865
                    2251.1271503')
           INFO     Remove worker addr: tcp://127.0.0.1:43229  scheduler.py:5444
                    name: 3
                    (stimulus_id='handle-worker-cleanup-176865
                    2251.1341343')
           INFO     Lost all workers                           scheduler.py:5582
           INFO     Nanny at 'tcp://127.0.0.1:36395' closed.        nanny.py:626
           INFO     Nanny at 'tcp://127.0.0.1:46329' closed.        nanny.py:626
           INFO     Batched Comm Closed <TCP (closed) Scheduler   batched.py:122
                    connection to worker
                    local=tcp://127.0.0.1:35475
                    remote=tcp://127.0.0.1:48404>
                    ╭──── Traceback (most recent call last) ────╮
                    │ /app/.venv/lib/python3.12/site-packages/d │
                    │ istributed/batched.py:115 in              │
                    │ _background_send                          │
                    │                                           │
                    │   112 │   │   │   │   │   │   payload, se │
                    │   113 │   │   │   │   │   )               │
                    │   114 │   │   │   │   ) as coro:          │
                    │ ❱ 115 │   │   │   │   │   nbytes = yield  │
                    │   116 │   │   │   │   if nbytes < 1e6:    │
                    │   117 │   │   │   │   │   self.recent_mes │
                    │   118 │   │   │   │   else:               │
                    │                                           │
                    │ /app/.venv/lib/python3.12/site-packages/t │
                    │ ornado/gen.py:783 in run                  │
                    │                                           │
                    │   780 │   │   │   │   self.future = None  │
                    │   781 │   │   │   │   try:                │
                    │   782 │   │   │   │   │   try:            │
                    │ ❱ 783 │   │   │   │   │   │   value = fut │
                    │   784 │   │   │   │   │   except Exceptio │
                    │   785 │   │   │   │   │   │   # Save the  │
                    │   786 │   │   │   │   │   │   # gen.throw │
                    │                                           │
                    │ /app/.venv/lib/python3.12/site-packages/d │
                    │ istributed/comm/tcp.py:263 in write       │
                    │                                           │
                    │   260 │   async def write(self, msg, seri │
                    │   261 │   │   stream = self.stream        │
                    │   262 │   │   if stream is None:          │
                    │ ❱ 263 │   │   │   raise CommClosedError() │
                    │   264 │   │                               │
                    │   265 │   │   frames = await to_frames(   │
                    │   266 │   │   │   msg,                    │
                    ╰───────────────────────────────────────────╯
                    CommClosedError
           INFO     Batched Comm Closed <TCP (closed) Scheduler   batched.py:122
                    connection to worker
                    local=tcp://127.0.0.1:35475
                    remote=tcp://127.0.0.1:48384>
                    ╭──── Traceback (most recent call last) ────╮
                    │ /app/.venv/lib/python3.12/site-packages/d │
                    │ istributed/batched.py:115 in              │
                    │ _background_send                          │
                    │                                           │
                    │   112 │   │   │   │   │   │   payload, se │
                    │   113 │   │   │   │   │   )               │
                    │   114 │   │   │   │   ) as coro:          │
                    │ ❱ 115 │   │   │   │   │   nbytes = yield  │
                    │   116 │   │   │   │   if nbytes < 1e6:    │
                    │   117 │   │   │   │   │   self.recent_mes │
                    │   118 │   │   │   │   else:               │
                    │                                           │
                    │ /app/.venv/lib/python3.12/site-packages/t │
                    │ ornado/gen.py:783 in run                  │
                    │                                           │
                    │   780 │   │   │   │   self.future = None  │
                    │   781 │   │   │   │   try:                │
                    │   782 │   │   │   │   │   try:            │
                    │ ❱ 783 │   │   │   │   │   │   value = fut │
                    │   784 │   │   │   │   │   except Exceptio │
                    │   785 │   │   │   │   │   │   # Save the  │
                    │   786 │   │   │   │   │   │   # gen.throw │
                    │                                           │
                    │ /app/.venv/lib/python3.12/site-packages/d │
                    │ istributed/comm/tcp.py:263 in write       │
                    │                                           │
                    │   260 │   async def write(self, msg, seri │
                    │   261 │   │   stream = self.stream        │
                    │   262 │   │   if stream is None:          │
                    │ ❱ 263 │   │   │   raise CommClosedError() │
                    │   264 │   │                               │
                    │   265 │   │   frames = await to_frames(   │
                    │   266 │   │   │   msg,                    │
                    ╰───────────────────────────────────────────╯
                    CommClosedError
           INFO     Nanny at 'tcp://127.0.0.1:38879' closed.        nanny.py:626
           INFO     Nanny at 'tcp://127.0.0.1:34917' closed.        nanny.py:626
           INFO     Closing scheduler. Reason: unknown         scheduler.py:4343
           INFO     Scheduler closing all comms                scheduler.py:4371
           INFO     Retire worker addresses                    scheduler.py:7614
                    (stimulus_id='retire-workers-1768652251.83
                    75714') (0, 1, 2, 3)
           INFO     Closing Nanny at 'tcp://127.0.0.1:36953'.       nanny.py:611
                    Reason: nanny-close
           INFO     Nanny asking worker to close. Reason:           nanny.py:858
                    nanny-close
           INFO     Closing Nanny at 'tcp://127.0.0.1:36849'.       nanny.py:611
                    Reason: nanny-close
           INFO     Nanny asking worker to close. Reason:           nanny.py:858
                    nanny-close
           INFO     Closing Nanny at 'tcp://127.0.0.1:35047'.       nanny.py:611
                    Reason: nanny-close
           INFO     Nanny asking worker to close. Reason:           nanny.py:858
                    nanny-close
           INFO     Closing Nanny at 'tcp://127.0.0.1:34417'.       nanny.py:611
                    Reason: nanny-close
           INFO     Nanny asking worker to close. Reason:           nanny.py:858
                    nanny-close
           INFO     Received 'close-stream' from                     core.py:908
                    tcp://127.0.0.1:48288; closing.
           INFO     Received 'close-stream' from                     core.py:908
                    tcp://127.0.0.1:48304; closing.
           INFO     Remove worker addr: tcp://127.0.0.1:37063  scheduler.py:5444
                    name: 0
                    (stimulus_id='handle-worker-cleanup-176865
                    2251.9289846')
           INFO     Remove worker addr: tcp://127.0.0.1:42969  scheduler.py:5444
                    name: 1
                    (stimulus_id='handle-worker-cleanup-176865
                    2251.9535816')
           INFO     Received 'close-stream' from                     core.py:908
                    tcp://127.0.0.1:48272; closing.
           INFO     Remove worker addr: tcp://127.0.0.1:36285  scheduler.py:5444
                    name: 2
                    (stimulus_id='handle-worker-cleanup-176865
                    2251.9780967')
           INFO     Received 'close-stream' from                     core.py:908
                    tcp://127.0.0.1:48306; closing.
[12:17:32] INFO     Remove worker addr: tcp://127.0.0.1:33319  scheduler.py:5444
                    name: 3
                    (stimulus_id='handle-worker-cleanup-176865
                    2252.0009308')
           INFO     Lost all workers                           scheduler.py:5582
           INFO     Batched Comm Closed <TCP (closed) Scheduler   batched.py:122
                    connection to worker
                    local=tcp://127.0.0.1:37919
                    remote=tcp://127.0.0.1:48272>
                    ╭──── Traceback (most recent call last) ────╮
                    │ /app/.venv/lib/python3.12/site-packages/d │
                    │ istributed/batched.py:115 in              │
                    │ _background_send                          │
                    │                                           │
                    │   112 │   │   │   │   │   │   payload, se │
                    │   113 │   │   │   │   │   )               │
                    │   114 │   │   │   │   ) as coro:          │
                    │ ❱ 115 │   │   │   │   │   nbytes = yield  │
                    │   116 │   │   │   │   if nbytes < 1e6:    │
                    │   117 │   │   │   │   │   self.recent_mes │
                    │   118 │   │   │   │   else:               │
                    │                                           │
                    │ /app/.venv/lib/python3.12/site-packages/t │
                    │ ornado/gen.py:783 in run                  │
                    │                                           │
                    │   780 │   │   │   │   self.future = None  │
                    │   781 │   │   │   │   try:                │
                    │   782 │   │   │   │   │   try:            │
                    │ ❱ 783 │   │   │   │   │   │   value = fut │
                    │   784 │   │   │   │   │   except Exceptio │
                    │   785 │   │   │   │   │   │   # Save the  │
                    │   786 │   │   │   │   │   │   # gen.throw │
                    │                                           │
                    │ /app/.venv/lib/python3.12/site-packages/d │
                    │ istributed/comm/tcp.py:263 in write       │
                    │                                           │
                    │   260 │   async def write(self, msg, seri │
                    │   261 │   │   stream = self.stream        │
                    │   262 │   │   if stream is None:          │
                    │ ❱ 263 │   │   │   raise CommClosedError() │
                    │   264 │   │                               │
                    │   265 │   │   frames = await to_frames(   │
                    │   266 │   │   │   msg,                    │
                    ╰───────────────────────────────────────────╯
                    CommClosedError
           INFO     Nanny at 'tcp://127.0.0.1:36849' closed.        nanny.py:626
           INFO     Nanny at 'tcp://127.0.0.1:36953' closed.        nanny.py:626
           INFO     Nanny at 'tcp://127.0.0.1:35047' closed.        nanny.py:626
           INFO     Nanny at 'tcp://127.0.0.1:34417' closed.        nanny.py:626
           INFO     Closing scheduler. Reason: unknown         scheduler.py:4343
           INFO     Scheduler closing all comms                scheduler.py:4371
           INFO     Retire worker addresses                    scheduler.py:7614
                    (stimulus_id='retire-workers-1768652252.46
                    65725') (0, 1, 2, 3)
           INFO     Closing Nanny at 'tcp://127.0.0.1:44169'.       nanny.py:611
                    Reason: nanny-close
           INFO     Nanny asking worker to close. Reason:           nanny.py:858
                    nanny-close
           INFO     Closing Nanny at 'tcp://127.0.0.1:34809'.       nanny.py:611
                    Reason: nanny-close
           INFO     Nanny asking worker to close. Reason:           nanny.py:858
                    nanny-close
           INFO     Closing Nanny at 'tcp://127.0.0.1:44907'.       nanny.py:611
                    Reason: nanny-close
           INFO     Nanny asking worker to close. Reason:           nanny.py:858
                    nanny-close
           INFO     Closing Nanny at 'tcp://127.0.0.1:35313'.       nanny.py:611
                    Reason: nanny-close
           INFO     Nanny asking worker to close. Reason:           nanny.py:858
                    nanny-close
           INFO     Received 'close-stream' from                     core.py:908
                    tcp://127.0.0.1:52324; closing.
           INFO     Received 'close-stream' from                     core.py:908
                    tcp://127.0.0.1:52314; closing.
           INFO     Received 'close-stream' from                     core.py:908
                    tcp://127.0.0.1:52328; closing.
           INFO     Remove worker addr: tcp://127.0.0.1:33717  scheduler.py:5444
                    name: 1
                    (stimulus_id='handle-worker-cleanup-176865
                    2252.5659678')
           INFO     Remove worker addr: tcp://127.0.0.1:39765  scheduler.py:5444
                    name: 0
                    (stimulus_id='handle-worker-cleanup-176865
                    2252.5803146')
           INFO     Remove worker addr: tcp://127.0.0.1:33033  scheduler.py:5444
                    name: 2
                    (stimulus_id='handle-worker-cleanup-176865
                    2252.60432')
           INFO     Received 'close-stream' from                     core.py:908
                    tcp://127.0.0.1:52334; closing.
           INFO     Remove worker addr: tcp://127.0.0.1:42811  scheduler.py:5444
                    name: 3
                    (stimulus_id='handle-worker-cleanup-176865
                    2252.6456094')
           INFO     Lost all workers                           scheduler.py:5582
           INFO     Batched Comm Closed <TCP (closed) Scheduler   batched.py:122
                    connection to worker
                    local=tcp://127.0.0.1:39609
                    remote=tcp://127.0.0.1:52334>
                    ╭──── Traceback (most recent call last) ────╮
                    │ /app/.venv/lib/python3.12/site-packages/d │
                    │ istributed/batched.py:115 in              │
                    │ _background_send                          │
                    │                                           │
                    │   112 │   │   │   │   │   │   payload, se │
                    │   113 │   │   │   │   │   )               │
                    │   114 │   │   │   │   ) as coro:          │
                    │ ❱ 115 │   │   │   │   │   nbytes = yield  │
                    │   116 │   │   │   │   if nbytes < 1e6:    │
                    │   117 │   │   │   │   │   self.recent_mes │
                    │   118 │   │   │   │   else:               │
                    │                                           │
                    │ /app/.venv/lib/python3.12/site-packages/t │
                    │ ornado/gen.py:783 in run                  │
                    │                                           │
                    │   780 │   │   │   │   self.future = None  │
                    │   781 │   │   │   │   try:                │
                    │   782 │   │   │   │   │   try:            │
                    │ ❱ 783 │   │   │   │   │   │   value = fut │
                    │   784 │   │   │   │   │   except Exceptio │
                    │   785 │   │   │   │   │   │   # Save the  │
                    │   786 │   │   │   │   │   │   # gen.throw │
                    │                                           │
                    │ /app/.venv/lib/python3.12/site-packages/d │
                    │ istributed/comm/tcp.py:263 in write       │
                    │                                           │
                    │   260 │   async def write(self, msg, seri │
                    │   261 │   │   stream = self.stream        │
                    │   262 │   │   if stream is None:          │
                    │ ❱ 263 │   │   │   raise CommClosedError() │
                    │   264 │   │                               │
                    │   265 │   │   frames = await to_frames(   │
                    │   266 │   │   │   msg,                    │
                    ╰───────────────────────────────────────────╯
                    CommClosedError
           INFO     Nanny at 'tcp://127.0.0.1:44169' closed.        nanny.py:626
           INFO     Nanny at 'tcp://127.0.0.1:34809' closed.        nanny.py:626
           INFO     Nanny at 'tcp://127.0.0.1:35313' closed.        nanny.py:626
           INFO     Nanny at 'tcp://127.0.0.1:44907' closed.        nanny.py:626
           INFO     Closing scheduler. Reason: unknown         scheduler.py:4343
           INFO     Scheduler closing all comms                scheduler.py:4371
           INFO     Retire worker addresses                    scheduler.py:7614
                    (stimulus_id='retire-workers-1768652252.97
                    7106') (0, 1, 2, 3)
           INFO     Closing Nanny at 'tcp://127.0.0.1:42255'.       nanny.py:611
                    Reason: nanny-close
           INFO     Nanny asking worker to close. Reason:           nanny.py:858
                    nanny-close
           INFO     Closing Nanny at 'tcp://127.0.0.1:45529'.       nanny.py:611
                    Reason: nanny-close
           INFO     Nanny asking worker to close. Reason:           nanny.py:858
                    nanny-close
           INFO     Closing Nanny at 'tcp://127.0.0.1:42893'.       nanny.py:611
                    Reason: nanny-close
[12:17:33] INFO     Nanny asking worker to close. Reason:           nanny.py:858
                    nanny-close
           INFO     Closing Nanny at 'tcp://127.0.0.1:33399'.       nanny.py:611
                    Reason: nanny-close
           INFO     Nanny asking worker to close. Reason:           nanny.py:858
                    nanny-close
           INFO     Received 'close-stream' from                     core.py:908
                    tcp://127.0.0.1:36276; closing.
           INFO     Received 'close-stream' from                     core.py:908
                    tcp://127.0.0.1:36302; closing.
           INFO     Received 'close-stream' from                     core.py:908
                    tcp://127.0.0.1:36272; closing.
           INFO     Remove worker addr: tcp://127.0.0.1:43359  scheduler.py:5444
                    name: 0
                    (stimulus_id='handle-worker-cleanup-176865
                    2253.0371473')
           INFO     Remove worker addr: tcp://127.0.0.1:36265  scheduler.py:5444
                    name: 1
                    (stimulus_id='handle-worker-cleanup-176865
                    2253.0427096')
           INFO     Remove worker addr: tcp://127.0.0.1:46489  scheduler.py:5444
                    name: 2
                    (stimulus_id='handle-worker-cleanup-176865
                    2253.0608253')
           INFO     Received 'close-stream' from                     core.py:908
                    tcp://127.0.0.1:36288; closing.
           INFO     Remove worker addr: tcp://127.0.0.1:44727  scheduler.py:5444
                    name: 3
                    (stimulus_id='handle-worker-cleanup-176865
                    2253.1023326')
           INFO     Lost all workers                           scheduler.py:5582
           INFO     Nanny at 'tcp://127.0.0.1:42255' closed.        nanny.py:626
           INFO     Nanny at 'tcp://127.0.0.1:45529' closed.        nanny.py:626
           INFO     Nanny at 'tcp://127.0.0.1:42893' closed.        nanny.py:626
           INFO     Nanny at 'tcp://127.0.0.1:33399' closed.        nanny.py:626
           INFO     Closing scheduler. Reason: unknown         scheduler.py:4343
           INFO     Scheduler closing all comms                scheduler.py:4371
           INFO     Retire worker addresses                    scheduler.py:7614
                    (stimulus_id='retire-workers-1768652253.31
                    43198') (0, 1, 2, 3)
           INFO     Closing Nanny at 'tcp://127.0.0.1:39561'.       nanny.py:611
                    Reason: nanny-close
           INFO     Nanny asking worker to close. Reason:           nanny.py:858
                    nanny-close
           INFO     Closing Nanny at 'tcp://127.0.0.1:35567'.       nanny.py:611
                    Reason: nanny-close
           INFO     Nanny asking worker to close. Reason:           nanny.py:858
                    nanny-close
           INFO     Closing Nanny at 'tcp://127.0.0.1:39021'.       nanny.py:611
                    Reason: nanny-close
           INFO     Nanny asking worker to close. Reason:           nanny.py:858
                    nanny-close
           INFO     Closing Nanny at 'tcp://127.0.0.1:45361'.       nanny.py:611
                    Reason: nanny-close
           INFO     Nanny asking worker to close. Reason:           nanny.py:858
                    nanny-close
           INFO     Received 'close-stream' from                     core.py:908
                    tcp://127.0.0.1:33572; closing.
           INFO     Received 'close-stream' from                     core.py:908
                    tcp://127.0.0.1:33586; closing.
           INFO     Remove worker addr: tcp://127.0.0.1:46857  scheduler.py:5444
                    name: 0
                    (stimulus_id='handle-worker-cleanup-176865
                    2253.3733282')
           INFO     Remove worker addr: tcp://127.0.0.1:45999  scheduler.py:5444
                    name: 1
                    (stimulus_id='handle-worker-cleanup-176865
                    2253.3779616')
           INFO     Received 'close-stream' from                     core.py:908
                    tcp://127.0.0.1:33602; closing.
           INFO     Remove worker addr: tcp://127.0.0.1:46807  scheduler.py:5444
                    name: 2
                    (stimulus_id='handle-worker-cleanup-176865
                    2253.3893478')
           INFO     Received 'close-stream' from                     core.py:908
                    tcp://127.0.0.1:33606; closing.
           INFO     Batched Comm Closed <TCP (closed) Scheduler   batched.py:122
                    connection to worker
                    local=tcp://127.0.0.1:37951
                    remote=tcp://127.0.0.1:33602>
                    ╭──── Traceback (most recent call last) ────╮
                    │ /app/.venv/lib/python3.12/site-packages/d │
                    │ istributed/batched.py:115 in              │
                    │ _background_send                          │
                    │                                           │
                    │   112 │   │   │   │   │   │   payload, se │
                    │   113 │   │   │   │   │   )               │
                    │   114 │   │   │   │   ) as coro:          │
                    │ ❱ 115 │   │   │   │   │   nbytes = yield  │
                    │   116 │   │   │   │   if nbytes < 1e6:    │
                    │   117 │   │   │   │   │   self.recent_mes │
                    │   118 │   │   │   │   else:               │
                    │                                           │
                    │ /app/.venv/lib/python3.12/site-packages/t │
                    │ ornado/gen.py:783 in run                  │
                    │                                           │
                    │   780 │   │   │   │   self.future = None  │
                    │   781 │   │   │   │   try:                │
                    │   782 │   │   │   │   │   try:            │
                    │ ❱ 783 │   │   │   │   │   │   value = fut │
                    │   784 │   │   │   │   │   except Exceptio │
                    │   785 │   │   │   │   │   │   # Save the  │
                    │   786 │   │   │   │   │   │   # gen.throw │
                    │                                           │
                    │ /app/.venv/lib/python3.12/site-packages/d │
                    │ istributed/comm/tcp.py:263 in write       │
                    │                                           │
                    │   260 │   async def write(self, msg, seri │
                    │   261 │   │   stream = self.stream        │
                    │   262 │   │   if stream is None:          │
                    │ ❱ 263 │   │   │   raise CommClosedError() │
                    │   264 │   │                               │
                    │   265 │   │   frames = await to_frames(   │
                    │   266 │   │   │   msg,                    │
                    ╰───────────────────────────────────────────╯
                    CommClosedError
           INFO     Remove worker addr: tcp://127.0.0.1:41975  scheduler.py:5444
                    name: 3
                    (stimulus_id='handle-worker-cleanup-176865
                    2253.636833')
           INFO     Lost all workers                           scheduler.py:5582
           INFO     Nanny at 'tcp://127.0.0.1:39561' closed.        nanny.py:626
           INFO     Nanny at 'tcp://127.0.0.1:35567' closed.        nanny.py:626
           INFO     Nanny at 'tcp://127.0.0.1:45361' closed.        nanny.py:626
           INFO     Nanny at 'tcp://127.0.0.1:39021' closed.        nanny.py:626
           INFO     Closing scheduler. Reason: unknown         scheduler.py:4343
           INFO     Scheduler closing all comms                scheduler.py:4371
           INFO     Retire worker addresses                    scheduler.py:7614
                    (stimulus_id='retire-workers-1768652253.68
                    7139') (0, 1, 2, 3)
           INFO     Closing Nanny at 'tcp://127.0.0.1:36245'.       nanny.py:611
                    Reason: nanny-close
           INFO     Nanny asking worker to close. Reason:           nanny.py:858
                    nanny-close
           INFO     Closing Nanny at 'tcp://127.0.0.1:35311'.       nanny.py:611
                    Reason: nanny-close
           INFO     Nanny asking worker to close. Reason:           nanny.py:858
                    nanny-close
           INFO     Closing Nanny at 'tcp://127.0.0.1:43199'.       nanny.py:611
                    Reason: nanny-close
           INFO     Nanny asking worker to close. Reason:           nanny.py:858
                    nanny-close
           INFO     Closing Nanny at 'tcp://127.0.0.1:42773'.       nanny.py:611
                    Reason: nanny-close
           INFO     Nanny asking worker to close. Reason:           nanny.py:858
                    nanny-close
           INFO     Received 'close-stream' from                     core.py:908
                    tcp://127.0.0.1:41456; closing.
           INFO     Received 'close-stream' from                     core.py:908
                    tcp://127.0.0.1:41476; closing.
           INFO     Received 'close-stream' from                     core.py:908
                    tcp://127.0.0.1:41464; closing.
           INFO     Remove worker addr: tcp://127.0.0.1:37883  scheduler.py:5444
                    name: 0
                    (stimulus_id='handle-worker-cleanup-176865
                    2253.7322628')
           INFO     Remove worker addr: tcp://127.0.0.1:44045  scheduler.py:5444
                    name: 1
                    (stimulus_id='handle-worker-cleanup-176865
                    2253.7375808')
           INFO     Remove worker addr: tcp://127.0.0.1:34161  scheduler.py:5444
                    name: 2
                    (stimulus_id='handle-worker-cleanup-176865
                    2253.7420669')
           INFO     Received 'close-stream' from                     core.py:908
                    tcp://127.0.0.1:41492; closing.
           INFO     Remove worker addr: tcp://127.0.0.1:35367  scheduler.py:5444
                    name: 3
                    (stimulus_id='handle-worker-cleanup-176865
                    2253.7560112')
           INFO     Lost all workers                           scheduler.py:5582
           INFO     Nanny at 'tcp://127.0.0.1:36245' closed.        nanny.py:626
           INFO     Nanny at 'tcp://127.0.0.1:35311' closed.        nanny.py:626
           INFO     Nanny at 'tcp://127.0.0.1:42773' closed.        nanny.py:626
           INFO     Nanny at 'tcp://127.0.0.1:43199' closed.        nanny.py:626
           INFO     Closing scheduler. Reason: unknown         scheduler.py:4343
           INFO     Scheduler closing all comms                scheduler.py:4371
           INFO     Retire worker addresses                    scheduler.py:7614
                    (stimulus_id='retire-workers-1768652253.94
                    6157') (0, 1, 2, 3)
           INFO     Closing Nanny at 'tcp://127.0.0.1:40409'.       nanny.py:611
                    Reason: nanny-close
           INFO     Nanny asking worker to close. Reason:           nanny.py:858
                    nanny-close
           INFO     Closing Nanny at 'tcp://127.0.0.1:35499'.       nanny.py:611
                    Reason: nanny-close
           INFO     Nanny asking worker to close. Reason:           nanny.py:858
                    nanny-close
           INFO     Closing Nanny at 'tcp://127.0.0.1:45291'.       nanny.py:611
                    Reason: nanny-close
           INFO     Nanny asking worker to close. Reason:           nanny.py:858
                    nanny-close
           INFO     Closing Nanny at 'tcp://127.0.0.1:45629'.       nanny.py:611
                    Reason: nanny-close
           INFO     Nanny asking worker to close. Reason:           nanny.py:858
                    nanny-close
           INFO     Received 'close-stream' from                     core.py:908
                    tcp://127.0.0.1:44328; closing.
           INFO     Received 'close-stream' from                     core.py:908
                    tcp://127.0.0.1:44330; closing.
           INFO     Remove worker addr: tcp://127.0.0.1:40325  scheduler.py:5444
                    name: 0
                    (stimulus_id='handle-worker-cleanup-176865
                    2253.9841697')
           INFO     Remove worker addr: tcp://127.0.0.1:35161  scheduler.py:5444
                    name: 1
                    (stimulus_id='handle-worker-cleanup-176865
                    2253.9901118')
           INFO     Received 'close-stream' from                     core.py:908
                    tcp://127.0.0.1:44336; closing.
           INFO     Remove worker addr: tcp://127.0.0.1:35901  scheduler.py:5444
                    name: 2
                    (stimulus_id='handle-worker-cleanup-176865
                    2253.9973612')
[12:17:34] INFO     Batched Comm Closed <TCP (closed) Scheduler   batched.py:122
                    connection to worker
                    local=tcp://127.0.0.1:34941
                    remote=tcp://127.0.0.1:44336>
                    ╭──── Traceback (most recent call last) ────╮
                    │ /app/.venv/lib/python3.12/site-packages/d │
                    │ istributed/batched.py:115 in              │
                    │ _background_send                          │
                    │                                           │
                    │   112 │   │   │   │   │   │   payload, se │
                    │   113 │   │   │   │   │   )               │
                    │   114 │   │   │   │   ) as coro:          │
                    │ ❱ 115 │   │   │   │   │   nbytes = yield  │
                    │   116 │   │   │   │   if nbytes < 1e6:    │
                    │   117 │   │   │   │   │   self.recent_mes │
                    │   118 │   │   │   │   else:               │
                    │                                           │
                    │ /app/.venv/lib/python3.12/site-packages/t │
                    │ ornado/gen.py:783 in run                  │
                    │                                           │
                    │   780 │   │   │   │   self.future = None  │
                    │   781 │   │   │   │   try:                │
                    │   782 │   │   │   │   │   try:            │
                    │ ❱ 783 │   │   │   │   │   │   value = fut │
                    │   784 │   │   │   │   │   except Exceptio │
                    │   785 │   │   │   │   │   │   # Save the  │
                    │   786 │   │   │   │   │   │   # gen.throw │
                    │                                           │
                    │ /app/.venv/lib/python3.12/site-packages/d │
                    │ istributed/comm/tcp.py:263 in write       │
                    │                                           │
                    │   260 │   async def write(self, msg, seri │
                    │   261 │   │   stream = self.stream        │
                    │   262 │   │   if stream is None:          │
                    │ ❱ 263 │   │   │   raise CommClosedError() │
                    │   264 │   │                               │
                    │   265 │   │   frames = await to_frames(   │
                    │   266 │   │   │   msg,                    │
                    ╰───────────────────────────────────────────╯
                    CommClosedError
           INFO     Received 'close-stream' from                     core.py:908
                    tcp://127.0.0.1:44346; closing.
           INFO     Remove worker addr: tcp://127.0.0.1:37747  scheduler.py:5444
                    name: 3
                    (stimulus_id='handle-worker-cleanup-176865
                    2254.1738844')
           INFO     Lost all workers                           scheduler.py:5582
           INFO     Nanny at 'tcp://127.0.0.1:40409' closed.        nanny.py:626
           INFO     Nanny at 'tcp://127.0.0.1:45291' closed.        nanny.py:626
           INFO     Nanny at 'tcp://127.0.0.1:35499' closed.        nanny.py:626
           INFO     Nanny at 'tcp://127.0.0.1:45629' closed.        nanny.py:626
           INFO     Closing scheduler. Reason: unknown         scheduler.py:4343
           INFO     Scheduler closing all comms                scheduler.py:4371
/app/.venv/lib/python3.12/site-packages/coverage/inorout.py:497: CoverageWarning:

Module dev_src was never imported. (module-not-imported); see https://coverage.readthedocs.io/en/7.13.1/messages.html#warning-module-not-imported

/app/.venv/lib/python3.12/site-packages/coverage/inorout.py:497: CoverageWarning:

Module src was never imported. (module-not-imported); see https://coverage.readthedocs.io/en/7.13.1/messages.html#warning-module-not-imported

/app/.venv/lib/python3.12/site-packages/coverage/control.py:958: CoverageWarning:

No data was collected. (no-data-collected); see https://coverage.readthedocs.io/en/7.13.1/messages.html#warning-no-data-collected

/app/.venv/lib/python3.12/site-packages/pytest_cov/plugin.py:363: CovReportWarning:

Failed to generate report: No data to report.
