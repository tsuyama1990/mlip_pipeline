============================= test session starts ==============================
platform linux -- Python 3.12.12, pytest-9.0.2, pluggy-1.6.0
rootdir: /app
configfile: pyproject.toml
testpaths: tests
plugins: mock-3.15.1, cov-7.0.0
collected 72 items

tests/integration/test_dft_integration.py ....                           [  5%]
tests/integration/test_monitoring_integration.py ...                     [  9%]
tests/modules/test_config_generator.py .                                 [ 11%]
tests/modules/test_dft.py ...F..                                         [ 19%]
tests/modules/test_dft_heuristics.py .......                             [ 29%]
tests/modules/test_exploration.py .....ss                                [ 38%]
tests/modules/test_explorer.py ....                                      [ 44%]
tests/modules/test_generator.py ....                                     [ 50%]
tests/modules/test_inference.py ...                                      [ 54%]
tests/modules/test_training.py ....                                      [ 59%]
tests/test_app.py ...                                                    [ 63%]
tests/test_config.py .....                                               [ 70%]
tests/test_config_factory.py .                                           [ 72%]
tests/test_database.py ...                                               [ 76%]
tests/test_logging.py .                                                  [ 77%]
tests/test_monitoring.py ...                                             [ 81%]
tests/test_workflow_manager.py .......                                   [ 91%]
tests/utils/test_resilience.py ......
WARNING: Failed to generate report: No data to report.

                                                                         [100%]

=================================== FAILURES ===================================
______________________ test_process_runner_logs_on_error _______________________

caplog = <_pytest.logging.LogCaptureFixture object at 0x7f877fb90050>
tmp_path = PosixPath('/tmp/pytest-of-jules/pytest-22/test_process_runner_logs_on_er0')

    def test_process_runner_logs_on_error(caplog, tmp_path):
        """Verify that the QEProcessRunner logs stdout/stderr on failure."""
        mock_profile = MagicMock(spec=EspressoProfile)
        mock_profile.get_command.return_value = ["non_existent_command"]
        runner = QEProcessRunner(profile=mock_profile)

        input_file = tmp_path / "test.in"
        output_file = tmp_path / "test.out"
        input_file.touch()

        with pytest.raises(FileNotFoundError):
            runner.execute(input_file, output_file)
>       assert "QE executable not found" in caplog.text
E       AssertionError: assert 'QE executable not found' in ''
E        +  where '' = <_pytest.logging.LogCaptureFixture object at 0x7f877fb90050>.text

tests/modules/test_dft.py:137: AssertionError
=============================== warnings summary ===============================
.venv/lib/python3.12/site-packages/e3nn/o3/_wigner.py:10
  /app/.venv/lib/python3.12/site-packages/e3nn/o3/_wigner.py:10: UserWarning: Environment variable TORCH_FORCE_NO_WEIGHTS_ONLY_LOAD detected, since the`weights_only` argument was not explicitly passed to `torch.load`, forcing weights_only=False.
    _Jd, _W3j_flat, _W3j_indices = torch.load(os.path.join(os.path.dirname(__file__), 'constants.pt'))

tests/modules/test_exploration.py:128
  /app/tests/modules/test_exploration.py:128: PytestUnknownMarkWarning: Unknown pytest.mark.integration - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.integration

tests/modules/test_exploration.py:138
  /app/tests/modules/test_exploration.py:138: PytestUnknownMarkWarning: Unknown pytest.mark.integration - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.integration

tests/modules/test_inference.py:70
  /app/tests/modules/test_inference.py:70: PytestUnknownMarkWarning: Unknown pytest.mark.integration - is this a typo?  You can register custom marks to avoid this warning - for details, see https://docs.pytest.org/en/stable/how-to/mark.html
    @pytest.mark.integration

tests/test_workflow_manager.py::test_save_checkpoint
  /app/.venv/lib/python3.12/site-packages/distributed/node.py:188: UserWarning:

  Port 8787 is already in use.
  Perhaps you already have a cluster running?
  Hosting the HTTP server on port 45903 instead

tests/test_workflow_manager.py::test_load_checkpoint
  /app/.venv/lib/python3.12/site-packages/distributed/node.py:188: UserWarning:

  Port 8787 is already in use.
  Perhaps you already have a cluster running?
  Hosting the HTTP server on port 41299 instead

tests/test_workflow_manager.py::test_init_does_not_load_state_unnecessarily
  /app/.venv/lib/python3.12/site-packages/distributed/node.py:188: UserWarning:

  Port 8787 is already in use.
  Perhaps you already have a cluster running?
  Hosting the HTTP server on port 32901 instead

tests/test_workflow_manager.py::test_resubmit_pending_jobs
  /app/.venv/lib/python3.12/site-packages/distributed/node.py:188: UserWarning:

  Port 8787 is already in use.
  Perhaps you already have a cluster running?
  Hosting the HTTP server on port 39535 instead

tests/test_workflow_manager.py::test_checkpoint_training_history
  /app/.venv/lib/python3.12/site-packages/distributed/node.py:188: UserWarning:

  Port 8787 is already in use.
  Perhaps you already have a cluster running?
  Hosting the HTTP server on port 42741 instead

tests/test_workflow_manager.py::test_checkpoint_training_history
  /app/.venv/lib/python3.12/site-packages/distributed/node.py:188: UserWarning:

  Port 8787 is already in use.
  Perhaps you already have a cluster running?
  Hosting the HTTP server on port 36629 instead

tests/test_workflow_manager.py::test_perform_training
  /app/.venv/lib/python3.12/site-packages/distributed/node.py:188: UserWarning:

  Port 8787 is already in use.
  Perhaps you already have a cluster running?
  Hosting the HTTP server on port 35547 instead

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
================================ tests coverage ================================
_______________ coverage: platform linux, python 3.12.12-final-0 _______________

=========================== short test summary info ============================
FAILED tests/modules/test_dft.py::test_process_runner_logs_on_error - Asserti...
======= 1 failed, 69 passed, 2 skipped, 11 warnings in 140.00s (0:02:20) =======
[12:03:00] INFO     Retire worker addresses                    scheduler.py:7614
                    (stimulus_id='retire-workers-1768651380.99
                    95754') (0, 1, 2, 3)
[12:03:01] INFO     Closing Nanny at 'tcp://127.0.0.1:38437'.       nanny.py:611
                    Reason: nanny-close
           INFO     Nanny asking worker to close. Reason:           nanny.py:858
                    nanny-close
           INFO     Closing Nanny at 'tcp://127.0.0.1:36009'.       nanny.py:611
                    Reason: nanny-close
           INFO     Nanny asking worker to close. Reason:           nanny.py:858
                    nanny-close
           INFO     Closing Nanny at 'tcp://127.0.0.1:39307'.       nanny.py:611
                    Reason: nanny-close
           INFO     Nanny asking worker to close. Reason:           nanny.py:858
                    nanny-close
           INFO     Closing Nanny at 'tcp://127.0.0.1:39283'.       nanny.py:611
                    Reason: nanny-close
           INFO     Nanny asking worker to close. Reason:           nanny.py:858
                    nanny-close
           INFO     Received 'close-stream' from                     core.py:908
                    tcp://127.0.0.1:38286; closing.
           INFO     Received 'close-stream' from                     core.py:908
                    tcp://127.0.0.1:38300; closing.
           INFO     Remove worker addr: tcp://127.0.0.1:33971  scheduler.py:5444
                    name: 0
                    (stimulus_id='handle-worker-cleanup-176865
                    1381.0901089')
           INFO     Remove worker addr: tcp://127.0.0.1:37313  scheduler.py:5444
                    name: 1
                    (stimulus_id='handle-worker-cleanup-176865
                    1381.1166701')
           INFO     Received 'close-stream' from                     core.py:908
                    tcp://127.0.0.1:38316; closing.
           INFO     Received 'close-stream' from                     core.py:908
                    tcp://127.0.0.1:38326; closing.
           INFO     Remove worker addr: tcp://127.0.0.1:33193  scheduler.py:5444
                    name: 2
                    (stimulus_id='handle-worker-cleanup-176865
                    1381.176483')
           INFO     Remove worker addr: tcp://127.0.0.1:34423  scheduler.py:5444
                    name: 3
                    (stimulus_id='handle-worker-cleanup-176865
                    1381.2105334')
           INFO     Lost all workers                           scheduler.py:5582
           INFO     Batched Comm Closed <TCP (closed) Scheduler   batched.py:122
                    connection to worker
                    local=tcp://127.0.0.1:46093
                    remote=tcp://127.0.0.1:38316>
                    ╭──── Traceback (most recent call last) ────╮
                    │ /app/.venv/lib/python3.12/site-packages/d │
                    │ istributed/batched.py:115 in              │
                    │ _background_send                          │
                    │                                           │
                    │   112 │   │   │   │   │   │   payload, se │
                    │   113 │   │   │   │   │   )               │
                    │   114 │   │   │   │   ) as coro:          │
                    │ ❱ 115 │   │   │   │   │   nbytes = yield  │
                    │   116 │   │   │   │   if nbytes < 1e6:    │
                    │   117 │   │   │   │   │   self.recent_mes │
                    │   118 │   │   │   │   else:               │
                    │                                           │
                    │ /app/.venv/lib/python3.12/site-packages/t │
                    │ ornado/gen.py:783 in run                  │
                    │                                           │
                    │   780 │   │   │   │   self.future = None  │
                    │   781 │   │   │   │   try:                │
                    │   782 │   │   │   │   │   try:            │
                    │ ❱ 783 │   │   │   │   │   │   value = fut │
                    │   784 │   │   │   │   │   except Exceptio │
                    │   785 │   │   │   │   │   │   # Save the  │
                    │   786 │   │   │   │   │   │   # gen.throw │
                    │                                           │
                    │ /app/.venv/lib/python3.12/site-packages/d │
                    │ istributed/comm/tcp.py:263 in write       │
                    │                                           │
                    │   260 │   async def write(self, msg, seri │
                    │   261 │   │   stream = self.stream        │
                    │   262 │   │   if stream is None:          │
                    │ ❱ 263 │   │   │   raise CommClosedError() │
                    │   264 │   │                               │
                    │   265 │   │   frames = await to_frames(   │
                    │   266 │   │   │   msg,                    │
                    ╰───────────────────────────────────────────╯
                    CommClosedError
           INFO     Batched Comm Closed <TCP (closed) Scheduler   batched.py:122
                    connection to worker
                    local=tcp://127.0.0.1:46093
                    remote=tcp://127.0.0.1:38326>
                    ╭──── Traceback (most recent call last) ────╮
                    │ /app/.venv/lib/python3.12/site-packages/d │
                    │ istributed/batched.py:115 in              │
                    │ _background_send                          │
                    │                                           │
                    │   112 │   │   │   │   │   │   payload, se │
                    │   113 │   │   │   │   │   )               │
                    │   114 │   │   │   │   ) as coro:          │
                    │ ❱ 115 │   │   │   │   │   nbytes = yield  │
                    │   116 │   │   │   │   if nbytes < 1e6:    │
                    │   117 │   │   │   │   │   self.recent_mes │
                    │   118 │   │   │   │   else:               │
                    │                                           │
                    │ /app/.venv/lib/python3.12/site-packages/t │
                    │ ornado/gen.py:783 in run                  │
                    │                                           │
                    │   780 │   │   │   │   self.future = None  │
                    │   781 │   │   │   │   try:                │
                    │   782 │   │   │   │   │   try:            │
                    │ ❱ 783 │   │   │   │   │   │   value = fut │
                    │   784 │   │   │   │   │   except Exceptio │
                    │   785 │   │   │   │   │   │   # Save the  │
                    │   786 │   │   │   │   │   │   # gen.throw │
                    │                                           │
                    │ /app/.venv/lib/python3.12/site-packages/d │
                    │ istributed/comm/tcp.py:263 in write       │
                    │                                           │
                    │   260 │   async def write(self, msg, seri │
                    │   261 │   │   stream = self.stream        │
                    │   262 │   │   if stream is None:          │
                    │ ❱ 263 │   │   │   raise CommClosedError() │
                    │   264 │   │                               │
                    │   265 │   │   frames = await to_frames(   │
                    │   266 │   │   │   msg,                    │
                    ╰───────────────────────────────────────────╯
                    CommClosedError
           INFO     Nanny at 'tcp://127.0.0.1:39283' closed.        nanny.py:626
           INFO     Nanny at 'tcp://127.0.0.1:38437' closed.        nanny.py:626
           INFO     Nanny at 'tcp://127.0.0.1:39307' closed.        nanny.py:626
           INFO     Nanny at 'tcp://127.0.0.1:36009' closed.        nanny.py:626
           INFO     Closing scheduler. Reason: unknown         scheduler.py:4343
           INFO     Scheduler closing all comms                scheduler.py:4371
[12:03:02] INFO     Retire worker addresses                    scheduler.py:7614
                    (stimulus_id='retire-workers-1768651382.14
                    69948') (0, 1, 2, 3)
           INFO     Closing Nanny at 'tcp://127.0.0.1:39419'.       nanny.py:611
                    Reason: nanny-close
           INFO     Nanny asking worker to close. Reason:           nanny.py:858
                    nanny-close
           INFO     Closing Nanny at 'tcp://127.0.0.1:43313'.       nanny.py:611
                    Reason: nanny-close
           INFO     Nanny asking worker to close. Reason:           nanny.py:858
                    nanny-close
           INFO     Closing Nanny at 'tcp://127.0.0.1:44805'.       nanny.py:611
                    Reason: nanny-close
           INFO     Nanny asking worker to close. Reason:           nanny.py:858
                    nanny-close
           INFO     Closing Nanny at 'tcp://127.0.0.1:41971'.       nanny.py:611
                    Reason: nanny-close
           INFO     Nanny asking worker to close. Reason:           nanny.py:858
                    nanny-close
           INFO     Received 'close-stream' from                     core.py:908
                    tcp://127.0.0.1:56908; closing.
           INFO     Received 'close-stream' from                     core.py:908
                    tcp://127.0.0.1:56896; closing.
           INFO     Received 'close-stream' from                     core.py:908
                    tcp://127.0.0.1:56932; closing.
           INFO     Remove worker addr: tcp://127.0.0.1:41011  scheduler.py:5444
                    name: 0
                    (stimulus_id='handle-worker-cleanup-176865
                    1382.2713962')
           INFO     Remove worker addr: tcp://127.0.0.1:36707  scheduler.py:5444
                    name: 2
                    (stimulus_id='handle-worker-cleanup-176865
                    1382.3063703')
           INFO     Remove worker addr: tcp://127.0.0.1:37645  scheduler.py:5444
                    name: 1
                    (stimulus_id='handle-worker-cleanup-176865
                    1382.3225152')
           INFO     Received 'close-stream' from                     core.py:908
                    tcp://127.0.0.1:56922; closing.
           INFO     Remove worker addr: tcp://127.0.0.1:37859  scheduler.py:5444
                    name: 3
                    (stimulus_id='handle-worker-cleanup-176865
                    1382.3668134')
           INFO     Lost all workers                           scheduler.py:5582
           INFO     Batched Comm Closed <TCP (closed) Scheduler   batched.py:122
                    connection to worker
                    local=tcp://127.0.0.1:35539
                    remote=tcp://127.0.0.1:56922>
                    ╭──── Traceback (most recent call last) ────╮
                    │ /app/.venv/lib/python3.12/site-packages/d │
                    │ istributed/batched.py:115 in              │
                    │ _background_send                          │
                    │                                           │
                    │   112 │   │   │   │   │   │   payload, se │
                    │   113 │   │   │   │   │   )               │
                    │   114 │   │   │   │   ) as coro:          │
                    │ ❱ 115 │   │   │   │   │   nbytes = yield  │
                    │   116 │   │   │   │   if nbytes < 1e6:    │
                    │   117 │   │   │   │   │   self.recent_mes │
                    │   118 │   │   │   │   else:               │
                    │                                           │
                    │ /app/.venv/lib/python3.12/site-packages/t │
                    │ ornado/gen.py:783 in run                  │
                    │                                           │
                    │   780 │   │   │   │   self.future = None  │
                    │   781 │   │   │   │   try:                │
                    │   782 │   │   │   │   │   try:            │
                    │ ❱ 783 │   │   │   │   │   │   value = fut │
                    │   784 │   │   │   │   │   except Exceptio │
                    │   785 │   │   │   │   │   │   # Save the  │
                    │   786 │   │   │   │   │   │   # gen.throw │
                    │                                           │
                    │ /app/.venv/lib/python3.12/site-packages/d │
                    │ istributed/comm/tcp.py:263 in write       │
                    │                                           │
                    │   260 │   async def write(self, msg, seri │
                    │   261 │   │   stream = self.stream        │
                    │   262 │   │   if stream is None:          │
                    │ ❱ 263 │   │   │   raise CommClosedError() │
                    │   264 │   │                               │
                    │   265 │   │   frames = await to_frames(   │
                    │   266 │   │   │   msg,                    │
                    ╰───────────────────────────────────────────╯
                    CommClosedError
           INFO     Nanny at 'tcp://127.0.0.1:41971' closed.        nanny.py:626
           INFO     Nanny at 'tcp://127.0.0.1:44805' closed.        nanny.py:626
           INFO     Nanny at 'tcp://127.0.0.1:39419' closed.        nanny.py:626
           INFO     Nanny at 'tcp://127.0.0.1:43313' closed.        nanny.py:626
           INFO     Closing scheduler. Reason: unknown         scheduler.py:4343
           INFO     Scheduler closing all comms                scheduler.py:4371
           INFO     Retire worker addresses                    scheduler.py:7614
                    (stimulus_id='retire-workers-1768651382.84
                    09722') (0, 1, 2, 3)
           INFO     Closing Nanny at 'tcp://127.0.0.1:42727'.       nanny.py:611
                    Reason: nanny-close
           INFO     Nanny asking worker to close. Reason:           nanny.py:858
                    nanny-close
           INFO     Closing Nanny at 'tcp://127.0.0.1:41437'.       nanny.py:611
                    Reason: nanny-close
           INFO     Nanny asking worker to close. Reason:           nanny.py:858
                    nanny-close
           INFO     Closing Nanny at 'tcp://127.0.0.1:35917'.       nanny.py:611
                    Reason: nanny-close
           INFO     Nanny asking worker to close. Reason:           nanny.py:858
                    nanny-close
           INFO     Closing Nanny at 'tcp://127.0.0.1:45737'.       nanny.py:611
                    Reason: nanny-close
           INFO     Nanny asking worker to close. Reason:           nanny.py:858
                    nanny-close
           INFO     Received 'close-stream' from                     core.py:908
                    tcp://127.0.0.1:46958; closing.
           INFO     Received 'close-stream' from                     core.py:908
                    tcp://127.0.0.1:48210; closing.
           INFO     Received 'close-stream' from                     core.py:908
                    tcp://127.0.0.1:46968; closing.
           INFO     Remove worker addr: tcp://127.0.0.1:42945  scheduler.py:5444
                    name: 1
                    (stimulus_id='handle-worker-cleanup-176865
                    1382.937703')
           INFO     Remove worker addr: tcp://127.0.0.1:35611  scheduler.py:5444
                    name: 0
                    (stimulus_id='handle-worker-cleanup-176865
                    1382.9459271')
           INFO     Remove worker addr: tcp://127.0.0.1:38377  scheduler.py:5444
                    name: 2
                    (stimulus_id='handle-worker-cleanup-176865
                    1382.9533968')
           INFO     Received 'close-stream' from                     core.py:908
                    tcp://127.0.0.1:46946; closing.
           INFO     Remove worker addr: tcp://127.0.0.1:34333  scheduler.py:5444
                    name: 3
                    (stimulus_id='handle-worker-cleanup-176865
                    1382.9674256')
           INFO     Lost all workers                           scheduler.py:5582
[12:03:03] INFO     Nanny at 'tcp://127.0.0.1:41437' closed.        nanny.py:626
           INFO     Nanny at 'tcp://127.0.0.1:45737' closed.        nanny.py:626
           INFO     Nanny at 'tcp://127.0.0.1:35917' closed.        nanny.py:626
           INFO     Nanny at 'tcp://127.0.0.1:42727' closed.        nanny.py:626
           INFO     Closing scheduler. Reason: unknown         scheduler.py:4343
           INFO     Scheduler closing all comms                scheduler.py:4371
           INFO     Retire worker addresses                    scheduler.py:7614
                    (stimulus_id='retire-workers-1768651383.15
                    58924') (0, 1, 2, 3)
           INFO     Closing Nanny at 'tcp://127.0.0.1:43183'.       nanny.py:611
                    Reason: nanny-close
           INFO     Nanny asking worker to close. Reason:           nanny.py:858
                    nanny-close
           INFO     Closing Nanny at 'tcp://127.0.0.1:37073'.       nanny.py:611
                    Reason: nanny-close
           INFO     Nanny asking worker to close. Reason:           nanny.py:858
                    nanny-close
           INFO     Closing Nanny at 'tcp://127.0.0.1:40571'.       nanny.py:611
                    Reason: nanny-close
           INFO     Nanny asking worker to close. Reason:           nanny.py:858
                    nanny-close
           INFO     Closing Nanny at 'tcp://127.0.0.1:41249'.       nanny.py:611
                    Reason: nanny-close
           INFO     Nanny asking worker to close. Reason:           nanny.py:858
                    nanny-close
           INFO     Received 'close-stream' from                     core.py:908
                    tcp://127.0.0.1:58624; closing.
           INFO     Received 'close-stream' from                     core.py:908
                    tcp://127.0.0.1:58658; closing.
           INFO     Received 'close-stream' from                     core.py:908
                    tcp://127.0.0.1:58646; closing.
           INFO     Remove worker addr: tcp://127.0.0.1:38779  scheduler.py:5444
                    name: 0
                    (stimulus_id='handle-worker-cleanup-176865
                    1383.2414002')
           INFO     Remove worker addr: tcp://127.0.0.1:35185  scheduler.py:5444
                    name: 1
                    (stimulus_id='handle-worker-cleanup-176865
                    1383.2456124')
           INFO     Remove worker addr: tcp://127.0.0.1:46331  scheduler.py:5444
                    name: 2
                    (stimulus_id='handle-worker-cleanup-176865
                    1383.2526393')
           INFO     Received 'close-stream' from                     core.py:908
                    tcp://127.0.0.1:58632; closing.
           INFO     Remove worker addr: tcp://127.0.0.1:46767  scheduler.py:5444
                    name: 3
                    (stimulus_id='handle-worker-cleanup-176865
                    1383.2810905')
           INFO     Lost all workers                           scheduler.py:5582
           INFO     Batched Comm Closed <TCP (closed) Scheduler   batched.py:122
                    connection to worker
                    local=tcp://127.0.0.1:44211
                    remote=tcp://127.0.0.1:58632>
                    ╭──── Traceback (most recent call last) ────╮
                    │ /app/.venv/lib/python3.12/site-packages/d │
                    │ istributed/batched.py:115 in              │
                    │ _background_send                          │
                    │                                           │
                    │   112 │   │   │   │   │   │   payload, se │
                    │   113 │   │   │   │   │   )               │
                    │   114 │   │   │   │   ) as coro:          │
                    │ ❱ 115 │   │   │   │   │   nbytes = yield  │
                    │   116 │   │   │   │   if nbytes < 1e6:    │
                    │   117 │   │   │   │   │   self.recent_mes │
                    │   118 │   │   │   │   else:               │
                    │                                           │
                    │ /app/.venv/lib/python3.12/site-packages/t │
                    │ ornado/gen.py:783 in run                  │
                    │                                           │
                    │   780 │   │   │   │   self.future = None  │
                    │   781 │   │   │   │   try:                │
                    │   782 │   │   │   │   │   try:            │
                    │ ❱ 783 │   │   │   │   │   │   value = fut │
                    │   784 │   │   │   │   │   except Exceptio │
                    │   785 │   │   │   │   │   │   # Save the  │
                    │   786 │   │   │   │   │   │   # gen.throw │
                    │                                           │
                    │ /app/.venv/lib/python3.12/site-packages/d │
                    │ istributed/comm/tcp.py:263 in write       │
                    │                                           │
                    │   260 │   async def write(self, msg, seri │
                    │   261 │   │   stream = self.stream        │
                    │   262 │   │   if stream is None:          │
                    │ ❱ 263 │   │   │   raise CommClosedError() │
                    │   264 │   │                               │
                    │   265 │   │   frames = await to_frames(   │
                    │   266 │   │   │   msg,                    │
                    ╰───────────────────────────────────────────╯
                    CommClosedError
           INFO     Nanny at 'tcp://127.0.0.1:43183' closed.        nanny.py:626
           INFO     Nanny at 'tcp://127.0.0.1:37073' closed.        nanny.py:626
           INFO     Nanny at 'tcp://127.0.0.1:40571' closed.        nanny.py:626
           INFO     Nanny at 'tcp://127.0.0.1:41249' closed.        nanny.py:626
           INFO     Closing scheduler. Reason: unknown         scheduler.py:4343
           INFO     Scheduler closing all comms                scheduler.py:4371
           INFO     Retire worker addresses                    scheduler.py:7614
                    (stimulus_id='retire-workers-1768651383.60
                    80701') (0, 1, 2, 3)
           INFO     Closing Nanny at 'tcp://127.0.0.1:34605'.       nanny.py:611
                    Reason: nanny-close
           INFO     Nanny asking worker to close. Reason:           nanny.py:858
                    nanny-close
           INFO     Closing Nanny at 'tcp://127.0.0.1:33343'.       nanny.py:611
                    Reason: nanny-close
           INFO     Nanny asking worker to close. Reason:           nanny.py:858
                    nanny-close
           INFO     Closing Nanny at 'tcp://127.0.0.1:32813'.       nanny.py:611
                    Reason: nanny-close
           INFO     Nanny asking worker to close. Reason:           nanny.py:858
                    nanny-close
           INFO     Closing Nanny at 'tcp://127.0.0.1:42069'.       nanny.py:611
                    Reason: nanny-close
           INFO     Nanny asking worker to close. Reason:           nanny.py:858
                    nanny-close
           INFO     Received 'close-stream' from                     core.py:908
                    tcp://127.0.0.1:45930; closing.
           INFO     Received 'close-stream' from                     core.py:908
                    tcp://127.0.0.1:45922; closing.
           INFO     Received 'close-stream' from                     core.py:908
                    tcp://127.0.0.1:45952; closing.
           INFO     Remove worker addr: tcp://127.0.0.1:44215  scheduler.py:5444
                    name: 0
                    (stimulus_id='handle-worker-cleanup-176865
                    1383.6948907')
           INFO     Remove worker addr: tcp://127.0.0.1:37629  scheduler.py:5444
                    name: 1
                    (stimulus_id='handle-worker-cleanup-176865
                    1383.7075946')
           INFO     Remove worker addr: tcp://127.0.0.1:41433  scheduler.py:5444
                    name: 2
                    (stimulus_id='handle-worker-cleanup-176865
                    1383.7141056')
           INFO     Received 'close-stream' from                     core.py:908
                    tcp://127.0.0.1:45944; closing.
           INFO     Remove worker addr: tcp://127.0.0.1:43301  scheduler.py:5444
                    name: 3
                    (stimulus_id='handle-worker-cleanup-176865
                    1383.7673106')
           INFO     Lost all workers                           scheduler.py:5582
           INFO     Batched Comm Closed <TCP (closed) Scheduler   batched.py:122
                    connection to worker
                    local=tcp://127.0.0.1:34287
                    remote=tcp://127.0.0.1:45944>
                    ╭──── Traceback (most recent call last) ────╮
                    │ /app/.venv/lib/python3.12/site-packages/d │
                    │ istributed/batched.py:115 in              │
                    │ _background_send                          │
                    │                                           │
                    │   112 │   │   │   │   │   │   payload, se │
                    │   113 │   │   │   │   │   )               │
                    │   114 │   │   │   │   ) as coro:          │
                    │ ❱ 115 │   │   │   │   │   nbytes = yield  │
                    │   116 │   │   │   │   if nbytes < 1e6:    │
                    │   117 │   │   │   │   │   self.recent_mes │
                    │   118 │   │   │   │   else:               │
                    │                                           │
                    │ /app/.venv/lib/python3.12/site-packages/t │
                    │ ornado/gen.py:783 in run                  │
                    │                                           │
                    │   780 │   │   │   │   self.future = None  │
                    │   781 │   │   │   │   try:                │
                    │   782 │   │   │   │   │   try:            │
                    │ ❱ 783 │   │   │   │   │   │   value = fut │
                    │   784 │   │   │   │   │   except Exceptio │
                    │   785 │   │   │   │   │   │   # Save the  │
                    │   786 │   │   │   │   │   │   # gen.throw │
                    │                                           │
                    │ /app/.venv/lib/python3.12/site-packages/d │
                    │ istributed/comm/tcp.py:263 in write       │
                    │                                           │
                    │   260 │   async def write(self, msg, seri │
                    │   261 │   │   stream = self.stream        │
                    │   262 │   │   if stream is None:          │
                    │ ❱ 263 │   │   │   raise CommClosedError() │
                    │   264 │   │                               │
                    │   265 │   │   frames = await to_frames(   │
                    │   266 │   │   │   msg,                    │
                    ╰───────────────────────────────────────────╯
                    CommClosedError
[12:03:04] INFO     Nanny at 'tcp://127.0.0.1:34605' closed.        nanny.py:626
           INFO     Nanny at 'tcp://127.0.0.1:33343' closed.        nanny.py:626
           INFO     Nanny at 'tcp://127.0.0.1:32813' closed.        nanny.py:626
           INFO     Nanny at 'tcp://127.0.0.1:42069' closed.        nanny.py:626
           INFO     Closing scheduler. Reason: unknown         scheduler.py:4343
           INFO     Scheduler closing all comms                scheduler.py:4371
           INFO     Retire worker addresses                    scheduler.py:7614
                    (stimulus_id='retire-workers-1768651384.08
                    69327') (0, 1, 2, 3)
           INFO     Closing Nanny at 'tcp://127.0.0.1:45927'.       nanny.py:611
                    Reason: nanny-close
           INFO     Nanny asking worker to close. Reason:           nanny.py:858
                    nanny-close
           INFO     Closing Nanny at 'tcp://127.0.0.1:33617'.       nanny.py:611
                    Reason: nanny-close
           INFO     Nanny asking worker to close. Reason:           nanny.py:858
                    nanny-close
           INFO     Closing Nanny at 'tcp://127.0.0.1:45729'.       nanny.py:611
                    Reason: nanny-close
           INFO     Nanny asking worker to close. Reason:           nanny.py:858
                    nanny-close
           INFO     Closing Nanny at 'tcp://127.0.0.1:44869'.       nanny.py:611
                    Reason: nanny-close
           INFO     Nanny asking worker to close. Reason:           nanny.py:858
                    nanny-close
           INFO     Received 'close-stream' from                     core.py:908
                    tcp://127.0.0.1:38672; closing.
           INFO     Received 'close-stream' from                     core.py:908
                    tcp://127.0.0.1:38660; closing.
           INFO     Received 'close-stream' from                     core.py:908
                    tcp://127.0.0.1:38644; closing.
           INFO     Remove worker addr: tcp://127.0.0.1:44397  scheduler.py:5444
                    name: 0
                    (stimulus_id='handle-worker-cleanup-176865
                    1384.140463')
           INFO     Remove worker addr: tcp://127.0.0.1:35563  scheduler.py:5444
                    name: 2
                    (stimulus_id='handle-worker-cleanup-176865
                    1384.146349')
           INFO     Remove worker addr: tcp://127.0.0.1:37953  scheduler.py:5444
                    name: 1
                    (stimulus_id='handle-worker-cleanup-176865
                    1384.151203')
           INFO     Received 'close-stream' from                     core.py:908
                    tcp://127.0.0.1:38632; closing.
           INFO     Remove worker addr: tcp://127.0.0.1:41241  scheduler.py:5444
                    name: 3
                    (stimulus_id='handle-worker-cleanup-176865
                    1384.1664257')
           INFO     Lost all workers                           scheduler.py:5582
           INFO     Nanny at 'tcp://127.0.0.1:44869' closed.        nanny.py:626
           INFO     Nanny at 'tcp://127.0.0.1:45927' closed.        nanny.py:626
           INFO     Nanny at 'tcp://127.0.0.1:45729' closed.        nanny.py:626
           INFO     Nanny at 'tcp://127.0.0.1:33617' closed.        nanny.py:626
           INFO     Closing scheduler. Reason: unknown         scheduler.py:4343
           INFO     Scheduler closing all comms                scheduler.py:4371
           INFO     Retire worker addresses                    scheduler.py:7614
                    (stimulus_id='retire-workers-1768651384.35
                    18414') (0, 1, 2, 3)
           INFO     Closing Nanny at 'tcp://127.0.0.1:35835'.       nanny.py:611
                    Reason: nanny-close
           INFO     Nanny asking worker to close. Reason:           nanny.py:858
                    nanny-close
           INFO     Closing Nanny at 'tcp://127.0.0.1:33615'.       nanny.py:611
                    Reason: nanny-close
           INFO     Nanny asking worker to close. Reason:           nanny.py:858
                    nanny-close
           INFO     Closing Nanny at 'tcp://127.0.0.1:35119'.       nanny.py:611
                    Reason: nanny-close
           INFO     Nanny asking worker to close. Reason:           nanny.py:858
                    nanny-close
           INFO     Closing Nanny at 'tcp://127.0.0.1:42321'.       nanny.py:611
                    Reason: nanny-close
           INFO     Nanny asking worker to close. Reason:           nanny.py:858
                    nanny-close
           INFO     Received 'close-stream' from                     core.py:908
                    tcp://127.0.0.1:34744; closing.
           INFO     Received 'close-stream' from                     core.py:908
                    tcp://127.0.0.1:34738; closing.
           INFO     Remove worker addr: tcp://127.0.0.1:38439  scheduler.py:5444
                    name: 0
                    (stimulus_id='handle-worker-cleanup-176865
                    1384.41239')
           INFO     Remove worker addr: tcp://127.0.0.1:43261  scheduler.py:5444
                    name: 1
                    (stimulus_id='handle-worker-cleanup-176865
                    1384.4220598')
           INFO     Received 'close-stream' from                     core.py:908
                    tcp://127.0.0.1:34756; closing.
           INFO     Remove worker addr: tcp://127.0.0.1:35583  scheduler.py:5444
                    name: 3
                    (stimulus_id='handle-worker-cleanup-176865
                    1384.4427962')
           INFO     Received 'close-stream' from                     core.py:908
                    tcp://127.0.0.1:34740; closing.
           INFO     Remove worker addr: tcp://127.0.0.1:45277  scheduler.py:5444
                    name: 2
                    (stimulus_id='handle-worker-cleanup-176865
                    1384.4656625')
           INFO     Lost all workers                           scheduler.py:5582
           INFO     Batched Comm Closed <TCP (closed) Scheduler   batched.py:122
                    connection to worker
                    local=tcp://127.0.0.1:37091
                    remote=tcp://127.0.0.1:34756>
                    ╭──── Traceback (most recent call last) ────╮
                    │ /app/.venv/lib/python3.12/site-packages/d │
                    │ istributed/batched.py:115 in              │
                    │ _background_send                          │
                    │                                           │
                    │   112 │   │   │   │   │   │   payload, se │
                    │   113 │   │   │   │   │   )               │
                    │   114 │   │   │   │   ) as coro:          │
                    │ ❱ 115 │   │   │   │   │   nbytes = yield  │
                    │   116 │   │   │   │   if nbytes < 1e6:    │
                    │   117 │   │   │   │   │   self.recent_mes │
                    │   118 │   │   │   │   else:               │
                    │                                           │
                    │ /app/.venv/lib/python3.12/site-packages/t │
                    │ ornado/gen.py:783 in run                  │
                    │                                           │
                    │   780 │   │   │   │   self.future = None  │
                    │   781 │   │   │   │   try:                │
                    │   782 │   │   │   │   │   try:            │
                    │ ❱ 783 │   │   │   │   │   │   value = fut │
                    │   784 │   │   │   │   │   except Exceptio │
                    │   785 │   │   │   │   │   │   # Save the  │
                    │   786 │   │   │   │   │   │   # gen.throw │
                    │                                           │
                    │ /app/.venv/lib/python3.12/site-packages/d │
                    │ istributed/comm/tcp.py:263 in write       │
                    │                                           │
                    │   260 │   async def write(self, msg, seri │
                    │   261 │   │   stream = self.stream        │
                    │   262 │   │   if stream is None:          │
                    │ ❱ 263 │   │   │   raise CommClosedError() │
                    │   264 │   │                               │
                    │   265 │   │   frames = await to_frames(   │
                    │   266 │   │   │   msg,                    │
                    ╰───────────────────────────────────────────╯
                    CommClosedError
           INFO     Nanny at 'tcp://127.0.0.1:35835' closed.        nanny.py:626
           INFO     Nanny at 'tcp://127.0.0.1:33615' closed.        nanny.py:626
           INFO     Nanny at 'tcp://127.0.0.1:42321' closed.        nanny.py:626
           INFO     Nanny at 'tcp://127.0.0.1:35119' closed.        nanny.py:626
           INFO     Closing scheduler. Reason: unknown         scheduler.py:4343
           INFO     Scheduler closing all comms                scheduler.py:4371
           INFO     Retire worker addresses                    scheduler.py:7614
                    (stimulus_id='retire-workers-1768651384.74
                    4895') (0, 1, 2, 3)
           INFO     Closing Nanny at 'tcp://127.0.0.1:35293'.       nanny.py:611
                    Reason: nanny-close
           INFO     Nanny asking worker to close. Reason:           nanny.py:858
                    nanny-close
           INFO     Closing Nanny at 'tcp://127.0.0.1:41967'.       nanny.py:611
                    Reason: nanny-close
           INFO     Nanny asking worker to close. Reason:           nanny.py:858
                    nanny-close
           INFO     Closing Nanny at 'tcp://127.0.0.1:41137'.       nanny.py:611
                    Reason: nanny-close
           INFO     Nanny asking worker to close. Reason:           nanny.py:858
                    nanny-close
           INFO     Closing Nanny at 'tcp://127.0.0.1:38755'.       nanny.py:611
                    Reason: nanny-close
           INFO     Nanny asking worker to close. Reason:           nanny.py:858
                    nanny-close
           INFO     Received 'close-stream' from                     core.py:908
                    tcp://127.0.0.1:38614; closing.
           INFO     Received 'close-stream' from                     core.py:908
                    tcp://127.0.0.1:38624; closing.
           INFO     Received 'close-stream' from                     core.py:908
                    tcp://127.0.0.1:38638; closing.
           INFO     Remove worker addr: tcp://127.0.0.1:43985  scheduler.py:5444
                    name: 0
                    (stimulus_id='handle-worker-cleanup-176865
                    1384.8058941')
           INFO     Remove worker addr: tcp://127.0.0.1:38037  scheduler.py:5444
                    name: 1
                    (stimulus_id='handle-worker-cleanup-176865
                    1384.8156083')
           INFO     Remove worker addr: tcp://127.0.0.1:44543  scheduler.py:5444
                    name: 2
                    (stimulus_id='handle-worker-cleanup-176865
                    1384.8241422')
           INFO     Received 'close-stream' from                     core.py:908
                    tcp://127.0.0.1:43142; closing.
           INFO     Remove worker addr: tcp://127.0.0.1:36483  scheduler.py:5444
                    name: 3
                    (stimulus_id='handle-worker-cleanup-176865
                    1384.8403578')
           INFO     Lost all workers                           scheduler.py:5582
           INFO     Batched Comm Closed <TCP (closed) Scheduler   batched.py:122
                    connection to worker
                    local=tcp://127.0.0.1:33503
                    remote=tcp://127.0.0.1:43142>
                    ╭──── Traceback (most recent call last) ────╮
                    │ /app/.venv/lib/python3.12/site-packages/d │
                    │ istributed/batched.py:115 in              │
                    │ _background_send                          │
                    │                                           │
                    │   112 │   │   │   │   │   │   payload, se │
                    │   113 │   │   │   │   │   )               │
                    │   114 │   │   │   │   ) as coro:          │
                    │ ❱ 115 │   │   │   │   │   nbytes = yield  │
                    │   116 │   │   │   │   if nbytes < 1e6:    │
                    │   117 │   │   │   │   │   self.recent_mes │
                    │   118 │   │   │   │   else:               │
                    │                                           │
                    │ /app/.venv/lib/python3.12/site-packages/t │
                    │ ornado/gen.py:783 in run                  │
                    │                                           │
                    │   780 │   │   │   │   self.future = None  │
                    │   781 │   │   │   │   try:                │
                    │   782 │   │   │   │   │   try:            │
                    │ ❱ 783 │   │   │   │   │   │   value = fut │
                    │   784 │   │   │   │   │   except Exceptio │
                    │   785 │   │   │   │   │   │   # Save the  │
                    │   786 │   │   │   │   │   │   # gen.throw │
                    │                                           │
                    │ /app/.venv/lib/python3.12/site-packages/d │
                    │ istributed/comm/tcp.py:263 in write       │
                    │                                           │
                    │   260 │   async def write(self, msg, seri │
                    │   261 │   │   stream = self.stream        │
                    │   262 │   │   if stream is None:          │
                    │ ❱ 263 │   │   │   raise CommClosedError() │
                    │   264 │   │                               │
                    │   265 │   │   frames = await to_frames(   │
                    │   266 │   │   │   msg,                    │
                    ╰───────────────────────────────────────────╯
                    CommClosedError
[12:03:05] INFO     Nanny at 'tcp://127.0.0.1:41967' closed.        nanny.py:626
           INFO     Nanny at 'tcp://127.0.0.1:35293' closed.        nanny.py:626
           INFO     Nanny at 'tcp://127.0.0.1:38755' closed.        nanny.py:626
           INFO     Nanny at 'tcp://127.0.0.1:41137' closed.        nanny.py:626
           INFO     Closing scheduler. Reason: unknown         scheduler.py:4343
           INFO     Scheduler closing all comms                scheduler.py:4371
/app/.venv/lib/python3.12/site-packages/coverage/inorout.py:497: CoverageWarning:

Module dev_src was never imported. (module-not-imported); see https://coverage.readthedocs.io/en/7.13.1/messages.html#warning-module-not-imported

/app/.venv/lib/python3.12/site-packages/coverage/inorout.py:497: CoverageWarning:

Module src was never imported. (module-not-imported); see https://coverage.readthedocs.io/en/7.13.1/messages.html#warning-module-not-imported

/app/.venv/lib/python3.12/site-packages/coverage/control.py:958: CoverageWarning:

No data was collected. (no-data-collected); see https://coverage.readthedocs.io/en/7.13.1/messages.html#warning-no-data-collected

/app/.venv/lib/python3.12/site-packages/pytest_cov/plugin.py:363: CovReportWarning:

Failed to generate report: No data to report.
